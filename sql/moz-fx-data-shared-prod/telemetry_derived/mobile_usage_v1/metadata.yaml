friendly_name: Mobile Usage
description: |-
  Layer on top of `firefox_nondesktop_exact_mau28_v1` that adds the
  CDOU field, which is a windowed sum.

  Should normally be accessed through the user-facing view
  `telemetry.mobile_usage_2021`.

  See also `telemetry.firefox_desktop_usage_2021`.

  This query can _almost_ be expressed as a single windowed sum over
  the base table, but has to deal with the edge case of very small
  slices in the underlying table. Very small slices may not show up
  every day, so we need to add extra logic to produce a dense that accounts
  for each slice consistently throughout the year, carrying over the accumulated
  CDOU for that slice even on days with no active clients.
owners:
- ascholtz@mozilla.com
labels:
  schedule: daily
  dag: bqetl_nondesktop
  owner1: ascholtz
scheduling:
  dag_name: bqetl_nondesktop
  date_partition_parameter: null
  external_downstream_tasks:
  - task_id: wait_for_mobile_usage
    dag_name: kpi_forecasting
    execution_delta: 1h
bigquery:
  time_partitioning:
    type: day
    field: submission_date
    require_partition_filter: false
    expiration_days: null
  clustering: null
workgroup_access:
- role: roles/bigquery.dataViewer
  members:
  - workgroup:mozilla-confidential
references:
  query.sql:
  - telemetry_derived.firefox_nondesktop_exact_mau28_v1
deprecated: false
