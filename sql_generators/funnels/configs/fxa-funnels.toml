destination_dataset = "telemetry_derived"

[funnels]

[funnels.registration_funnel]

steps = ["engage", "submit", "view"]
dimensions = ["os"]

[steps]

[steps.view]
friendly_name = "View"
description = "View marketing email"
data_source = "fxa_oauth_events"
select_expression = "fxa_content_auth_oauth_events"
where_expression = "event_type = 'fxa_email_first - view'"
aggregation = "count"

[steps.submit]
friendly_name = "Submit"
description = "View marketing email"
data_source = "fxa_oauth_events"
select_expression = "fxa_content_auth_oauth_events"
where_expression = "event_type = 'fxa_email_first - submit'"
aggregation = "count"

[steps.engage]
friendly_name = "Engage"
description = "Click on marketing email"
data_source = "fxa_oauth_events"
select_expression = "fxa_content_auth_oauth_events"
where_expression = "event_type = 'fxa_email_first - engage'"
aggregation = "count"


[data_sources]

[data_sources.fxa_oauth_events]
from_expression = "mozdata.firefox_accounts.fxa_content_auth_oauth_events"
submission_date_column = "DATE(timestamp)"
client_id_column = "user_id"

[dimensions]

[dimensions.os]
data_source = "fxa_oauth_events"
select_expression = "os_name"
friendly_name = "Operating System"
description = "Normalized Operating System"
