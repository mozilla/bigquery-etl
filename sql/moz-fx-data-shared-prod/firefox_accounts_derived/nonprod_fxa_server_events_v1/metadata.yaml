---
friendly_name: FxA Server Events (nonprod)
description: |
  FxA server events extracted from accounts server stdout logs.

  This new table is the direct result of FxA migration from AWS to GCP
  (see: OPST-296 for more context).

  Effective 2023-05-26 the events from the following servers land in this table
  (existing data will remain in those tables):
  - auth    (previous table: `nonprod_fxa_auth_events_v1`)
  - content (previous table: `nonprod_fxa_content_events_v1`)

  Payment server events will continue landing inside: `nonprod_fxa_stdout_events_v1`

owners:
  - kik@mozilla.com
labels:
  application: fxa
  incremental: true
  schedule: daily
scheduling:
  dag_name: bqetl_fxa_events
  arguments: ['--schema_update_option=ALLOW_FIELD_ADDITION']  # after initing the table with one column this should just add all the other fields automatically
bigquery:
  time_partitioning:
    type: day
    field: timestamp
    require_partition_filter: true
  # cannot set clustering via this config file as no schema.yaml
  # file due to how volatile the table schema can be.
  # To mitigate this we create the table using the init.sql file
  # which creates an empty table with the following fields and configuration:
  # - timestamp TIMESTAMP - partition field
  # - fxa_log STRING - cluster field
  # the argument ALLOW_FIELD_ADDITION takes care of adding all the missing field
  # as part of the ETL execution.
