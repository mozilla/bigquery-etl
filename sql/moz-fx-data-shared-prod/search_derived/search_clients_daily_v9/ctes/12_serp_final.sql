-- final_serp_cte
SELECT
  serp_events_clients_ad_enterprise_cte.client_id,
  serp_events_clients_ad_enterprise_cte.submission_date,
  serp_events_clients_ad_enterprise_cte.serp_provider_id,
  serp_events_clients_ad_enterprise_cte.partner_code,
  serp_events_clients_ad_enterprise_cte.serp_search_access_point,
  serp_events_clients_ad_enterprise_cte.sample_id,
  serp_events_clients_ad_enterprise_cte.profile_group_id,
  serp_events_clients_ad_enterprise_cte.legacy_telemetry_client_id,
  serp_events_clients_ad_enterprise_cte.country,
  serp_events_clients_ad_enterprise_cte.app_version,
  serp_events_clients_ad_enterprise_cte.channel,
  serp_events_clients_ad_enterprise_cte.normalized_channel,
  serp_events_clients_ad_enterprise_cte.locale,
  serp_events_clients_ad_enterprise_cte.os,
  serp_events_clients_ad_enterprise_cte.normalized_os,
  serp_events_clients_ad_enterprise_cte.os_version,
  serp_events_clients_ad_enterprise_cte.normalized_os_version,
  serp_events_clients_ad_enterprise_cte.os_version_major,
  serp_events_clients_ad_enterprise_cte.os_version_minor,
  serp_events_clients_ad_enterprise_cte.windows_build_number,
  serp_events_clients_ad_enterprise_cte.distribution_id,
  serp_events_clients_ad_enterprise_cte.profile_creation_date,
  serp_events_clients_ad_enterprise_cte.region_home_region,
  serp_events_clients_ad_enterprise_cte.usage_is_default_browser,
  serp_events_clients_ad_enterprise_cte.search_engine_default_display_name,
  serp_events_clients_ad_enterprise_cte.search_engine_default_load_path,
  serp_events_clients_ad_enterprise_cte.search_engine_default_partner_code,
  serp_events_clients_ad_enterprise_cte.search_engine_default_provider_id,
  serp_events_clients_ad_enterprise_cte.search_engine_default_submission_url,
  serp_events_clients_ad_enterprise_cte.search_engine_default_overridden_by_third_party,
  serp_events_clients_ad_enterprise_cte.search_engine_private_display_name,
  serp_events_clients_ad_enterprise_cte.search_engine_private_load_path,
  serp_events_clients_ad_enterprise_cte.search_engine_private_partner_code,
  serp_events_clients_ad_enterprise_cte.search_engine_private_provider_id,
  serp_events_clients_ad_enterprise_cte.search_engine_private_submission_url,
  serp_events_clients_ad_enterprise_cte.search_engine_private_overridden_by_third_party,
  serp_events_clients_ad_enterprise_cte.overridden_by_third_party,
  serp_events_clients_ad_enterprise_cte.subsession_start_time,
  serp_events_clients_ad_enterprise_cte.subsession_end_time,
  serp_events_clients_ad_enterprise_cte.subsession_counter,
  serp_events_clients_ad_enterprise_cte.experiments,
  serp_events_clients_ad_enterprise_cte.has_adblocker_addon,
  serp_events_clients_ad_enterprise_cte.policies_is_enterprise,
  serp_ad_click_target_cte.ad_click_target,
  serp_aggregates_cte.serp_ad_blocker_inferred,
  serp_aggregates_cte.serp_follow_on_searches_tagged_count,
  serp_aggregates_cte.serp_searches_tagged_count,
  serp_aggregates_cte.serp_searches_organic_count,
  serp_aggregates_cte.serp_with_ads_organic_count,
  serp_aggregates_cte.serp_with_ads_tagged_count,
  serp_aggregates_cte.serp_ad_clicks_tagged_count,
  serp_aggregates_cte.serp_ad_clicks_organic_count,
  serp_aggregates_cte.num_ad_clicks,
  serp_aggregates_cte.num_non_ad_link_clicks,
  serp_aggregates_cte.num_other_engagements,
  serp_aggregates_cte.num_ads_loaded,
  serp_aggregates_cte.num_ads_visible,
  serp_aggregates_cte.num_ads_blocked,
  serp_aggregates_cte.num_ads_notshowing,
  serp_aggregates_cte.profile_age_in_days,
  serp_aggregates_cte.serp_counts,
  serp_aggregates_cte.sessions_started_on_this_day,
  serp_aggregates_cte.active_hours_sum,
  serp_aggregates_cte.serp_scalar_parent_browser_engagement_tab_open_event_count_sum,
  serp_aggregates_cte.serp_scalar_parent_browser_engagement_total_uri_count_sum,
  serp_aggregates_cte.max_concurrent_tab_count_max
FROM
  serp_events_clients_ad_enterprise_cte
LEFT JOIN
  serp_ad_click_target_cte
  USING (client_id, submission_date, serp_provider_id, serp_search_access_point)
LEFT JOIN
  serp_aggregates_cte
  USING (client_id, submission_date, serp_provider_id, serp_search_access_point)
