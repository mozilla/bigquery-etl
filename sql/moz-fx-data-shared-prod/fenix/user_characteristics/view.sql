-- Generated via ./bqetl generate glean_usage
CREATE OR REPLACE VIEW
  `moz-fx-data-shared-prod.fenix.user_characteristics`
AS
SELECT
  "org_mozilla_firefox" AS normalized_app_id,
    -- set app build to 21850000 since all affected pings are coming from versions older than that
    -- abb build only used to differentiate between preview (pre 21850000) and nightly (everything after)
  mozfun.norm.fenix_app_info("org_mozilla_firefox", '21850000').channel AS normalized_channel,
  additional_properties,
  document_id,
  events,
  metadata,
  STRUCT(
    STRUCT(
      metrics.boolean.characteristics_font_name_list_emoji_modified,
      metrics.boolean.characteristics_inverted_colors,
      metrics.boolean.characteristics_monochrome,
      metrics.boolean.characteristics_pdf_viewer,
      metrics.boolean.characteristics_prefers_reduced_motion,
      metrics.boolean.characteristics_prefers_reduced_transparency,
      metrics.boolean.characteristics_prefs_block_popups,
      metrics.boolean.characteristics_prefs_browser_display_use_document_fonts,
      metrics.boolean.characteristics_prefs_general_autoscroll,
      metrics.boolean.characteristics_prefs_general_smoothscroll,
      metrics.boolean.characteristics_prefs_media_eme_enabled,
      metrics.boolean.characteristics_prefs_overlay_scrollbars,
      metrics.boolean.characteristics_prefs_privacy_donottrackheader_enabled,
      metrics.boolean.characteristics_prefs_privacy_globalprivacycontrol_enabled,
      metrics.boolean.characteristics_prefs_zoom_text_only,
      metrics.boolean.characteristics_use_document_colors,
      metrics.boolean.characteristics_video_dynamic_range,
      metrics.boolean.characteristics_using_accelerated_canvas
    ) AS `boolean`,
    STRUCT(
      metrics.labeled_counter.glean_error_invalid_label,
      metrics.labeled_counter.glean_error_invalid_overflow,
      metrics.labeled_counter.glean_error_invalid_state,
      metrics.labeled_counter.glean_error_invalid_value
    ) AS `labeled_counter`,
    STRUCT(
      metrics.quantity.characteristics_any_pointer_type,
      metrics.quantity.characteristics_audio_channels,
      metrics.quantity.characteristics_audio_fingerprint,
      metrics.quantity.characteristics_audio_frames,
      metrics.quantity.characteristics_audio_rate,
      metrics.quantity.characteristics_avail_height,
      metrics.quantity.characteristics_avail_width,
      metrics.quantity.characteristics_build_date,
      metrics.quantity.characteristics_color_accentcolor,
      metrics.quantity.characteristics_color_accentcolortext,
      metrics.quantity.characteristics_color_canvas,
      metrics.quantity.characteristics_color_canvastext,
      metrics.quantity.characteristics_color_depth,
      metrics.quantity.characteristics_color_gamut,
      metrics.quantity.characteristics_color_highlight,
      metrics.quantity.characteristics_color_highlighttext,
      metrics.quantity.characteristics_color_scheme,
      metrics.quantity.characteristics_color_selecteditem,
      metrics.quantity.characteristics_color_selecteditemtext,
      metrics.quantity.characteristics_font_default_modified,
      metrics.quantity.characteristics_font_minimum_size_modified,
      metrics.quantity.characteristics_font_name_list_cursive_modified,
      metrics.quantity.characteristics_font_name_list_monospace_modified,
      metrics.quantity.characteristics_font_name_list_sans_serif_modified,
      metrics.quantity.characteristics_font_name_list_serif_modified,
      metrics.quantity.characteristics_font_name_monospace_modified,
      metrics.quantity.characteristics_font_name_sans_serif_modified,
      metrics.quantity.characteristics_font_name_serif_modified,
      metrics.quantity.characteristics_font_size_monospace_modified,
      metrics.quantity.characteristics_font_size_variable_modified,
      metrics.quantity.characteristics_inner_height,
      metrics.quantity.characteristics_inner_width,
      metrics.quantity.characteristics_mathml1,
      metrics.quantity.characteristics_mathml10,
      metrics.quantity.characteristics_mathml2,
      metrics.quantity.characteristics_mathml3,
      metrics.quantity.characteristics_mathml4,
      metrics.quantity.characteristics_mathml5,
      metrics.quantity.characteristics_mathml6,
      metrics.quantity.characteristics_mathml7,
      metrics.quantity.characteristics_mathml8,
      metrics.quantity.characteristics_mathml9,
      metrics.quantity.characteristics_max_touch_points,
      metrics.quantity.characteristics_motion_decimals,
      metrics.quantity.characteristics_motion_freq,
      metrics.quantity.characteristics_orientation_angle,
      metrics.quantity.characteristics_orientation_decimals,
      metrics.quantity.characteristics_orientation_freq,
      metrics.quantity.characteristics_orientationabs_decimals,
      metrics.quantity.characteristics_orientationabs_freq,
      metrics.quantity.characteristics_outer_height,
      metrics.quantity.characteristics_outer_width,
      metrics.quantity.characteristics_pixel_depth,
      metrics.quantity.characteristics_pixel_ratio,
      metrics.quantity.characteristics_pointer_height,
      metrics.quantity.characteristics_pointer_tiltx,
      metrics.quantity.characteristics_pointer_tilty,
      metrics.quantity.characteristics_pointer_twist,
      metrics.quantity.characteristics_pointer_type,
      metrics.quantity.characteristics_pointer_width,
      metrics.quantity.characteristics_posx,
      metrics.quantity.characteristics_posy,
      metrics.quantity.characteristics_prefers_contrast,
      metrics.quantity.characteristics_prefs_network_cookie_cookiebehavior,
      metrics.quantity.characteristics_processor_count,
      metrics.quantity.characteristics_screen_height,
      metrics.quantity.characteristics_screen_orientation,
      metrics.quantity.characteristics_screen_width,
      metrics.quantity.characteristics_size_mode,
      metrics.quantity.characteristics_submission_schema,
      metrics.quantity.characteristics_target_frame_rate,
      metrics.quantity.characteristics_zoom_count,
      metrics.quantity.characteristics_camera_count,
      metrics.quantity.characteristics_gl_version,
      metrics.quantity.characteristics_group_count,
      metrics.quantity.characteristics_group_count_wo_speakers,
      metrics.quantity.characteristics_ice_order,
      metrics.quantity.characteristics_ice_sd,
      metrics.quantity.characteristics_microphone_count,
      metrics.quantity.characteristics_speaker_count,
      metrics.quantity.characteristics_voices_count,
      metrics.quantity.characteristics_voices_local_count,
      metrics.quantity.characteristics_gl_version_software,
      metrics.quantity.characteristics_wgpu_maxbindgroups,
      metrics.quantity.characteristics_wgpu_maxbindgroupsplusvertexbuffers,
      metrics.quantity.characteristics_wgpu_maxbindingsperbindgroup,
      metrics.quantity.characteristics_wgpu_maxbuffersize,
      metrics.quantity.characteristics_wgpu_maxcolorattachmentbytespersample,
      metrics.quantity.characteristics_wgpu_maxcolorattachments,
      metrics.quantity.characteristics_wgpu_maxcomputeinvocationsperworkgroup,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizex,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizey,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizez,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsperdimension,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupstoragesize,
      metrics.quantity.characteristics_wgpu_maxdynamicstoragebuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxdynamicuniformbuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxinterstageshadervariables,
      metrics.quantity.characteristics_wgpu_maxsampledtexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxsamplerspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragebufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxstoragebufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragetexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxtexturearraylayers,
      metrics.quantity.characteristics_wgpu_maxtexturedimension1d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension2d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension3d,
      metrics.quantity.characteristics_wgpu_maxuniformbufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxuniformbufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxvertexattributes,
      metrics.quantity.characteristics_wgpu_maxvertexbufferarraystride,
      metrics.quantity.characteristics_wgpu_maxvertexbuffers,
      metrics.quantity.characteristics_wgpu_minstoragebufferoffsetalignment,
      metrics.quantity.characteristics_wgpu_minuniformbufferoffsetalignment,
      metrics.quantity.characteristics_gl2_version_software
    ) AS `quantity`,
    STRUCT(
      metrics.string.characteristics_canvasdata1,
      metrics.string.characteristics_canvasdata10,
      metrics.string.characteristics_canvasdata10software,
      metrics.string.characteristics_canvasdata11_webgl,
      metrics.string.characteristics_canvasdata11_webglsoftware,
      metrics.string.characteristics_canvasdata12_fingerprintjs1,
      metrics.string.characteristics_canvasdata12_fingerprintjs1software,
      metrics.string.characteristics_canvasdata13_fingerprintjs2,
      metrics.string.characteristics_canvasdata13_fingerprintjs2software,
      metrics.string.characteristics_canvasdata1software,
      metrics.string.characteristics_canvasdata2,
      metrics.string.characteristics_canvasdata2software,
      metrics.string.characteristics_canvasdata3,
      metrics.string.characteristics_canvasdata3software,
      metrics.string.characteristics_canvasdata4,
      metrics.string.characteristics_canvasdata4software,
      metrics.string.characteristics_canvasdata5,
      metrics.string.characteristics_canvasdata5software,
      metrics.string.characteristics_canvasdata6,
      metrics.string.characteristics_canvasdata6software,
      metrics.string.characteristics_canvasdata7,
      metrics.string.characteristics_canvasdata7software,
      metrics.string.characteristics_canvasdata8,
      metrics.string.characteristics_canvasdata8software,
      metrics.string.characteristics_canvasdata9,
      metrics.string.characteristics_canvasdata9software,
      metrics.string.characteristics_changed_media_prefs,
      metrics.string.characteristics_channel,
      metrics.string.characteristics_cpu_model,
      metrics.string.characteristics_font_default_default_group,
      metrics.string.characteristics_font_default_western,
      metrics.string.characteristics_font_minimum_size_default_group,
      metrics.string.characteristics_font_minimum_size_western,
      metrics.string.characteristics_font_name_monospace_default_group,
      metrics.string.characteristics_font_name_monospace_western,
      metrics.string.characteristics_font_name_sans_serif_default_group,
      metrics.string.characteristics_font_name_sans_serif_western,
      metrics.string.characteristics_font_name_serif_default_group,
      metrics.string.characteristics_font_name_serif_western,
      metrics.string.characteristics_font_size_monospace_default_group,
      metrics.string.characteristics_font_size_monospace_western,
      metrics.string.characteristics_font_size_variable_default_group,
      metrics.string.characteristics_font_size_variable_western,
      metrics.string.characteristics_intl_locale,
      metrics.string.characteristics_keyboard_layout,
      metrics.string.characteristics_languages,
      metrics.string.characteristics_os_name,
      metrics.string.characteristics_os_version,
      metrics.string.characteristics_oscpu,
      metrics.string.characteristics_platform,
      metrics.string.characteristics_pointer_pressure,
      metrics.string.characteristics_pointer_tangentinal_pressure,
      metrics.string.characteristics_prefs_intl_accept_languages,
      metrics.string.characteristics_scalings,
      metrics.string.characteristics_system_locale,
      metrics.string.characteristics_text_anti_aliasing,
      metrics.string.characteristics_timezone,
      metrics.string.characteristics_touch_rotation_angle,
      metrics.string.characteristics_version,
      metrics.string.glean_client_annotation_experimentation_id,
      metrics.string.characteristics_gl_fragment_shader,
      metrics.string.characteristics_gl_renderer,
      metrics.string.characteristics_gl_renderer_raw,
      metrics.string.characteristics_gl_vendor,
      metrics.string.characteristics_gl_vendor_raw,
      metrics.string.characteristics_gl_version_raw,
      metrics.string.characteristics_gl_vertex_shader,
      metrics.string.characteristics_voices_all_ssdeep,
      metrics.string.characteristics_voices_default,
      metrics.string.characteristics_voices_local_ssdeep,
      metrics.string.characteristics_voices_nonlocal_ssdeep,
      metrics.string.characteristics_gl_context_type,
      metrics.string.characteristics_gl_context_type_software,
      metrics.string.characteristics_gl_fragment_shader_software,
      metrics.string.characteristics_gl_renderer_raw_software,
      metrics.string.characteristics_gl_renderer_software,
      metrics.string.characteristics_gl_vendor_raw_software,
      metrics.string.characteristics_gl_vendor_software,
      metrics.string.characteristics_gl_version_raw_software,
      metrics.string.characteristics_gl_vertex_shader_software,
      metrics.string.characteristics_canvasdata3avif,
      metrics.string.characteristics_canvasdata3avifsoftware,
      metrics.string.characteristics_canvasdata3cspsafe,
      metrics.string.characteristics_canvasdata3cspsafesoftware,
      metrics.string.characteristics_canvasdata3png,
      metrics.string.characteristics_canvasdata3pngsoftware,
      metrics.string.characteristics_canvasdata3webp,
      metrics.string.characteristics_canvasdata3webpsoftware,
      metrics.string.characteristics_canvas_feature_status,
      metrics.string.characteristics_wgpu_missing_features,
      metrics.string.characteristics_cpu_arch,
      metrics.string.characteristics_gl2_context_type,
      metrics.string.characteristics_gl2_context_type_software,
      metrics.string.characteristics_gl2_fragment_shader,
      metrics.string.characteristics_gl2_fragment_shader_software,
      metrics.string.characteristics_gl2_renderer,
      metrics.string.characteristics_gl2_renderer_raw,
      metrics.string.characteristics_gl2_renderer_raw_software,
      metrics.string.characteristics_gl2_renderer_software,
      metrics.string.characteristics_gl2_vendor,
      metrics.string.characteristics_gl2_vendor_raw,
      metrics.string.characteristics_gl2_vendor_raw_software,
      metrics.string.characteristics_gl2_vendor_software,
      metrics.string.characteristics_gl2_version_raw,
      metrics.string.characteristics_gl2_version_raw_software,
      metrics.string.characteristics_gl2_vertex_shader,
      metrics.string.characteristics_gl2_vertex_shader_software,
      metrics.string.characteristics_mathml1,
      metrics.string.characteristics_mathml10,
      metrics.string.characteristics_mathml2,
      metrics.string.characteristics_mathml3,
      metrics.string.characteristics_mathml4,
      metrics.string.characteristics_mathml5,
      metrics.string.characteristics_mathml6,
      metrics.string.characteristics_mathml7,
      metrics.string.characteristics_mathml8,
      metrics.string.characteristics_mathml9,
      metrics.string.characteristics_canvas_dpr
    ) AS `string`,
    STRUCT(metrics.string_list.characteristics_gamepads) AS `string_list`,
    STRUCT(
      metrics.text2.characteristics_audio_devices,
      metrics.text2.characteristics_canvasdata1,
      metrics.text2.characteristics_canvasdata10,
      metrics.text2.characteristics_canvasdata11_webgl,
      metrics.text2.characteristics_canvasdata12_fingerprintjs1,
      metrics.text2.characteristics_canvasdata13_fingerprintjs2,
      metrics.text2.characteristics_canvasdata2,
      metrics.text2.characteristics_canvasdata3,
      metrics.text2.characteristics_canvasdata4,
      metrics.text2.characteristics_canvasdata5,
      metrics.text2.characteristics_canvasdata6,
      metrics.text2.characteristics_canvasdata7,
      metrics.text2.characteristics_canvasdata8,
      metrics.text2.characteristics_canvasdata9,
      metrics.text2.characteristics_errors,
      metrics.text2.characteristics_ice_foundations,
      metrics.text2.characteristics_js_errors,
      metrics.text2.characteristics_math_ops,
      metrics.text2.characteristics_media_capabilities,
      metrics.text2.characteristics_media_devices,
      metrics.text2.characteristics_missing_fonts,
      metrics.text2.characteristics_voices,
      metrics.text2.characteristics_webglinfo,
      metrics.text2.characteristics_gl_extensions,
      metrics.text2.characteristics_gl_extensions_raw,
      metrics.text2.characteristics_gl_minimal_source,
      metrics.text2.characteristics_gl_params_extensions,
      metrics.text2.characteristics_gl_params_v1,
      metrics.text2.characteristics_gl_params_v2,
      metrics.text2.characteristics_gl_precision_fragment,
      metrics.text2.characteristics_gl_precision_vertex,
      metrics.text2.characteristics_media_capabilities_h264,
      metrics.text2.characteristics_media_capabilities_not_efficient,
      metrics.text2.characteristics_media_capabilities_not_smooth,
      metrics.text2.characteristics_media_capabilities_unsupported,
      metrics.text2.characteristics_voices_sample,
      metrics.text2.characteristics_voices_sha1,
      metrics.text2.characteristics_gl_extensions_raw_software,
      metrics.text2.characteristics_gl_extensions_software,
      metrics.text2.characteristics_gl_minimal_source_software,
      metrics.text2.characteristics_gl_params_extensions_software,
      metrics.text2.characteristics_gl_params_v1_software,
      metrics.text2.characteristics_gl_params_v2_software,
      metrics.text2.characteristics_gl_precision_fragment_software,
      metrics.text2.characteristics_gl_precision_vertex_software,
      metrics.text2.characteristics_user_agent,
      metrics.text2.characteristics_gl2_extensions,
      metrics.text2.characteristics_gl2_extensions_raw,
      metrics.text2.characteristics_gl2_extensions_raw_software,
      metrics.text2.characteristics_gl2_extensions_software,
      metrics.text2.characteristics_gl2_minimal_source,
      metrics.text2.characteristics_gl2_minimal_source_software,
      metrics.text2.characteristics_gl2_params,
      metrics.text2.characteristics_gl2_params_extensions,
      metrics.text2.characteristics_gl2_params_extensions_software,
      metrics.text2.characteristics_gl2_params_software,
      metrics.text2.characteristics_gl2_precision_fragment,
      metrics.text2.characteristics_gl2_precision_fragment_software,
      metrics.text2.characteristics_gl2_precision_vertex,
      metrics.text2.characteristics_gl2_precision_vertex_software,
      metrics.text2.characteristics_gl_params,
      metrics.text2.characteristics_gl_params_software,
      metrics.text2.characteristics_math_ops_fdlibm
    ) AS `text2`,
    STRUCT(metrics.uuid.characteristics_client_identifier) AS `uuid`
  ) AS `metrics`,
  normalized_app_name,
  normalized_country_code,
  normalized_os,
  normalized_os_version,
  sample_id,
  submission_timestamp
FROM
  `moz-fx-data-shared-prod.org_mozilla_firefox.user_characteristics`
UNION ALL
SELECT
  "org_mozilla_firefox_beta" AS normalized_app_id,
    -- set app build to 21850000 since all affected pings are coming from versions older than that
    -- abb build only used to differentiate between preview (pre 21850000) and nightly (everything after)
  mozfun.norm.fenix_app_info("org_mozilla_firefox_beta", '21850000').channel AS normalized_channel,
  additional_properties,
  document_id,
  events,
  metadata,
  STRUCT(
    STRUCT(
      metrics.boolean.characteristics_font_name_list_emoji_modified,
      metrics.boolean.characteristics_inverted_colors,
      metrics.boolean.characteristics_monochrome,
      metrics.boolean.characteristics_pdf_viewer,
      metrics.boolean.characteristics_prefers_reduced_motion,
      metrics.boolean.characteristics_prefers_reduced_transparency,
      metrics.boolean.characteristics_prefs_block_popups,
      metrics.boolean.characteristics_prefs_browser_display_use_document_fonts,
      metrics.boolean.characteristics_prefs_general_autoscroll,
      metrics.boolean.characteristics_prefs_general_smoothscroll,
      metrics.boolean.characteristics_prefs_media_eme_enabled,
      metrics.boolean.characteristics_prefs_overlay_scrollbars,
      metrics.boolean.characteristics_prefs_privacy_donottrackheader_enabled,
      metrics.boolean.characteristics_prefs_privacy_globalprivacycontrol_enabled,
      metrics.boolean.characteristics_prefs_zoom_text_only,
      metrics.boolean.characteristics_use_document_colors,
      metrics.boolean.characteristics_video_dynamic_range,
      metrics.boolean.characteristics_using_accelerated_canvas
    ) AS `boolean`,
    STRUCT(
      metrics.labeled_counter.glean_error_invalid_label,
      metrics.labeled_counter.glean_error_invalid_overflow,
      metrics.labeled_counter.glean_error_invalid_state,
      metrics.labeled_counter.glean_error_invalid_value
    ) AS `labeled_counter`,
    STRUCT(
      metrics.quantity.characteristics_any_pointer_type,
      metrics.quantity.characteristics_audio_channels,
      metrics.quantity.characteristics_audio_fingerprint,
      metrics.quantity.characteristics_audio_frames,
      metrics.quantity.characteristics_audio_rate,
      metrics.quantity.characteristics_avail_height,
      metrics.quantity.characteristics_avail_width,
      metrics.quantity.characteristics_build_date,
      metrics.quantity.characteristics_color_accentcolor,
      metrics.quantity.characteristics_color_accentcolortext,
      metrics.quantity.characteristics_color_canvas,
      metrics.quantity.characteristics_color_canvastext,
      metrics.quantity.characteristics_color_depth,
      metrics.quantity.characteristics_color_gamut,
      metrics.quantity.characteristics_color_highlight,
      metrics.quantity.characteristics_color_highlighttext,
      metrics.quantity.characteristics_color_scheme,
      metrics.quantity.characteristics_color_selecteditem,
      metrics.quantity.characteristics_color_selecteditemtext,
      metrics.quantity.characteristics_font_default_modified,
      metrics.quantity.characteristics_font_minimum_size_modified,
      metrics.quantity.characteristics_font_name_list_cursive_modified,
      metrics.quantity.characteristics_font_name_list_monospace_modified,
      metrics.quantity.characteristics_font_name_list_sans_serif_modified,
      metrics.quantity.characteristics_font_name_list_serif_modified,
      metrics.quantity.characteristics_font_name_monospace_modified,
      metrics.quantity.characteristics_font_name_sans_serif_modified,
      metrics.quantity.characteristics_font_name_serif_modified,
      metrics.quantity.characteristics_font_size_monospace_modified,
      metrics.quantity.characteristics_font_size_variable_modified,
      metrics.quantity.characteristics_inner_height,
      metrics.quantity.characteristics_inner_width,
      metrics.quantity.characteristics_mathml1,
      metrics.quantity.characteristics_mathml10,
      metrics.quantity.characteristics_mathml2,
      metrics.quantity.characteristics_mathml3,
      metrics.quantity.characteristics_mathml4,
      metrics.quantity.characteristics_mathml5,
      metrics.quantity.characteristics_mathml6,
      metrics.quantity.characteristics_mathml7,
      metrics.quantity.characteristics_mathml8,
      metrics.quantity.characteristics_mathml9,
      metrics.quantity.characteristics_max_touch_points,
      metrics.quantity.characteristics_motion_decimals,
      metrics.quantity.characteristics_motion_freq,
      metrics.quantity.characteristics_orientation_angle,
      metrics.quantity.characteristics_orientation_decimals,
      metrics.quantity.characteristics_orientation_freq,
      metrics.quantity.characteristics_orientationabs_decimals,
      metrics.quantity.characteristics_orientationabs_freq,
      metrics.quantity.characteristics_outer_height,
      metrics.quantity.characteristics_outer_width,
      metrics.quantity.characteristics_pixel_depth,
      metrics.quantity.characteristics_pixel_ratio,
      metrics.quantity.characteristics_pointer_height,
      metrics.quantity.characteristics_pointer_tiltx,
      metrics.quantity.characteristics_pointer_tilty,
      metrics.quantity.characteristics_pointer_twist,
      metrics.quantity.characteristics_pointer_type,
      metrics.quantity.characteristics_pointer_width,
      metrics.quantity.characteristics_posx,
      metrics.quantity.characteristics_posy,
      metrics.quantity.characteristics_prefers_contrast,
      metrics.quantity.characteristics_prefs_network_cookie_cookiebehavior,
      metrics.quantity.characteristics_processor_count,
      metrics.quantity.characteristics_screen_height,
      metrics.quantity.characteristics_screen_orientation,
      metrics.quantity.characteristics_screen_width,
      metrics.quantity.characteristics_size_mode,
      metrics.quantity.characteristics_submission_schema,
      metrics.quantity.characteristics_target_frame_rate,
      metrics.quantity.characteristics_zoom_count,
      metrics.quantity.characteristics_camera_count,
      metrics.quantity.characteristics_gl_version,
      metrics.quantity.characteristics_group_count,
      metrics.quantity.characteristics_group_count_wo_speakers,
      metrics.quantity.characteristics_ice_order,
      metrics.quantity.characteristics_ice_sd,
      metrics.quantity.characteristics_microphone_count,
      metrics.quantity.characteristics_speaker_count,
      metrics.quantity.characteristics_voices_count,
      metrics.quantity.characteristics_voices_local_count,
      metrics.quantity.characteristics_gl_version_software,
      metrics.quantity.characteristics_wgpu_maxbindgroups,
      metrics.quantity.characteristics_wgpu_maxbindgroupsplusvertexbuffers,
      metrics.quantity.characteristics_wgpu_maxbindingsperbindgroup,
      metrics.quantity.characteristics_wgpu_maxbuffersize,
      metrics.quantity.characteristics_wgpu_maxcolorattachmentbytespersample,
      metrics.quantity.characteristics_wgpu_maxcolorattachments,
      metrics.quantity.characteristics_wgpu_maxcomputeinvocationsperworkgroup,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizex,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizey,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizez,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsperdimension,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupstoragesize,
      metrics.quantity.characteristics_wgpu_maxdynamicstoragebuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxdynamicuniformbuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxinterstageshadervariables,
      metrics.quantity.characteristics_wgpu_maxsampledtexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxsamplerspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragebufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxstoragebufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragetexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxtexturearraylayers,
      metrics.quantity.characteristics_wgpu_maxtexturedimension1d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension2d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension3d,
      metrics.quantity.characteristics_wgpu_maxuniformbufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxuniformbufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxvertexattributes,
      metrics.quantity.characteristics_wgpu_maxvertexbufferarraystride,
      metrics.quantity.characteristics_wgpu_maxvertexbuffers,
      metrics.quantity.characteristics_wgpu_minstoragebufferoffsetalignment,
      metrics.quantity.characteristics_wgpu_minuniformbufferoffsetalignment,
      metrics.quantity.characteristics_gl2_version_software
    ) AS `quantity`,
    STRUCT(
      metrics.string.characteristics_canvasdata1,
      metrics.string.characteristics_canvasdata10,
      metrics.string.characteristics_canvasdata10software,
      metrics.string.characteristics_canvasdata11_webgl,
      metrics.string.characteristics_canvasdata11_webglsoftware,
      metrics.string.characteristics_canvasdata12_fingerprintjs1,
      metrics.string.characteristics_canvasdata12_fingerprintjs1software,
      metrics.string.characteristics_canvasdata13_fingerprintjs2,
      metrics.string.characteristics_canvasdata13_fingerprintjs2software,
      metrics.string.characteristics_canvasdata1software,
      metrics.string.characteristics_canvasdata2,
      metrics.string.characteristics_canvasdata2software,
      metrics.string.characteristics_canvasdata3,
      metrics.string.characteristics_canvasdata3software,
      metrics.string.characteristics_canvasdata4,
      metrics.string.characteristics_canvasdata4software,
      metrics.string.characteristics_canvasdata5,
      metrics.string.characteristics_canvasdata5software,
      metrics.string.characteristics_canvasdata6,
      metrics.string.characteristics_canvasdata6software,
      metrics.string.characteristics_canvasdata7,
      metrics.string.characteristics_canvasdata7software,
      metrics.string.characteristics_canvasdata8,
      metrics.string.characteristics_canvasdata8software,
      metrics.string.characteristics_canvasdata9,
      metrics.string.characteristics_canvasdata9software,
      metrics.string.characteristics_changed_media_prefs,
      metrics.string.characteristics_channel,
      metrics.string.characteristics_cpu_model,
      metrics.string.characteristics_font_default_default_group,
      metrics.string.characteristics_font_default_western,
      metrics.string.characteristics_font_minimum_size_default_group,
      metrics.string.characteristics_font_minimum_size_western,
      metrics.string.characteristics_font_name_monospace_default_group,
      metrics.string.characteristics_font_name_monospace_western,
      metrics.string.characteristics_font_name_sans_serif_default_group,
      metrics.string.characteristics_font_name_sans_serif_western,
      metrics.string.characteristics_font_name_serif_default_group,
      metrics.string.characteristics_font_name_serif_western,
      metrics.string.characteristics_font_size_monospace_default_group,
      metrics.string.characteristics_font_size_monospace_western,
      metrics.string.characteristics_font_size_variable_default_group,
      metrics.string.characteristics_font_size_variable_western,
      metrics.string.characteristics_intl_locale,
      metrics.string.characteristics_keyboard_layout,
      metrics.string.characteristics_languages,
      metrics.string.characteristics_os_name,
      metrics.string.characteristics_os_version,
      metrics.string.characteristics_oscpu,
      metrics.string.characteristics_platform,
      metrics.string.characteristics_pointer_pressure,
      metrics.string.characteristics_pointer_tangentinal_pressure,
      metrics.string.characteristics_prefs_intl_accept_languages,
      metrics.string.characteristics_scalings,
      metrics.string.characteristics_system_locale,
      metrics.string.characteristics_text_anti_aliasing,
      metrics.string.characteristics_timezone,
      metrics.string.characteristics_touch_rotation_angle,
      metrics.string.characteristics_version,
      metrics.string.glean_client_annotation_experimentation_id,
      metrics.string.characteristics_gl_fragment_shader,
      metrics.string.characteristics_gl_renderer,
      metrics.string.characteristics_gl_renderer_raw,
      metrics.string.characteristics_gl_vendor,
      metrics.string.characteristics_gl_vendor_raw,
      metrics.string.characteristics_gl_version_raw,
      metrics.string.characteristics_gl_vertex_shader,
      metrics.string.characteristics_voices_all_ssdeep,
      metrics.string.characteristics_voices_default,
      metrics.string.characteristics_voices_local_ssdeep,
      metrics.string.characteristics_voices_nonlocal_ssdeep,
      metrics.string.characteristics_gl_context_type,
      metrics.string.characteristics_gl_context_type_software,
      metrics.string.characteristics_gl_fragment_shader_software,
      metrics.string.characteristics_gl_renderer_raw_software,
      metrics.string.characteristics_gl_renderer_software,
      metrics.string.characteristics_gl_vendor_raw_software,
      metrics.string.characteristics_gl_vendor_software,
      metrics.string.characteristics_gl_version_raw_software,
      metrics.string.characteristics_gl_vertex_shader_software,
      metrics.string.characteristics_canvasdata3avif,
      metrics.string.characteristics_canvasdata3avifsoftware,
      metrics.string.characteristics_canvasdata3cspsafe,
      metrics.string.characteristics_canvasdata3cspsafesoftware,
      metrics.string.characteristics_canvasdata3png,
      metrics.string.characteristics_canvasdata3pngsoftware,
      metrics.string.characteristics_canvasdata3webp,
      metrics.string.characteristics_canvasdata3webpsoftware,
      metrics.string.characteristics_canvas_feature_status,
      metrics.string.characteristics_wgpu_missing_features,
      metrics.string.characteristics_cpu_arch,
      metrics.string.characteristics_gl2_context_type,
      metrics.string.characteristics_gl2_context_type_software,
      metrics.string.characteristics_gl2_fragment_shader,
      metrics.string.characteristics_gl2_fragment_shader_software,
      metrics.string.characteristics_gl2_renderer,
      metrics.string.characteristics_gl2_renderer_raw,
      metrics.string.characteristics_gl2_renderer_raw_software,
      metrics.string.characteristics_gl2_renderer_software,
      metrics.string.characteristics_gl2_vendor,
      metrics.string.characteristics_gl2_vendor_raw,
      metrics.string.characteristics_gl2_vendor_raw_software,
      metrics.string.characteristics_gl2_vendor_software,
      metrics.string.characteristics_gl2_version_raw,
      metrics.string.characteristics_gl2_version_raw_software,
      metrics.string.characteristics_gl2_vertex_shader,
      metrics.string.characteristics_gl2_vertex_shader_software,
      metrics.string.characteristics_mathml1,
      metrics.string.characteristics_mathml10,
      metrics.string.characteristics_mathml2,
      metrics.string.characteristics_mathml3,
      metrics.string.characteristics_mathml4,
      metrics.string.characteristics_mathml5,
      metrics.string.characteristics_mathml6,
      metrics.string.characteristics_mathml7,
      metrics.string.characteristics_mathml8,
      metrics.string.characteristics_mathml9,
      metrics.string.characteristics_canvas_dpr
    ) AS `string`,
    STRUCT(metrics.string_list.characteristics_gamepads) AS `string_list`,
    STRUCT(
      metrics.text2.characteristics_audio_devices,
      metrics.text2.characteristics_canvasdata1,
      metrics.text2.characteristics_canvasdata10,
      metrics.text2.characteristics_canvasdata11_webgl,
      metrics.text2.characteristics_canvasdata12_fingerprintjs1,
      metrics.text2.characteristics_canvasdata13_fingerprintjs2,
      metrics.text2.characteristics_canvasdata2,
      metrics.text2.characteristics_canvasdata3,
      metrics.text2.characteristics_canvasdata4,
      metrics.text2.characteristics_canvasdata5,
      metrics.text2.characteristics_canvasdata6,
      metrics.text2.characteristics_canvasdata7,
      metrics.text2.characteristics_canvasdata8,
      metrics.text2.characteristics_canvasdata9,
      metrics.text2.characteristics_errors,
      metrics.text2.characteristics_ice_foundations,
      metrics.text2.characteristics_js_errors,
      metrics.text2.characteristics_math_ops,
      metrics.text2.characteristics_media_capabilities,
      metrics.text2.characteristics_media_devices,
      metrics.text2.characteristics_missing_fonts,
      metrics.text2.characteristics_voices,
      metrics.text2.characteristics_webglinfo,
      metrics.text2.characteristics_gl_extensions,
      metrics.text2.characteristics_gl_extensions_raw,
      metrics.text2.characteristics_gl_minimal_source,
      metrics.text2.characteristics_gl_params_extensions,
      metrics.text2.characteristics_gl_params_v1,
      metrics.text2.characteristics_gl_params_v2,
      metrics.text2.characteristics_gl_precision_fragment,
      metrics.text2.characteristics_gl_precision_vertex,
      metrics.text2.characteristics_media_capabilities_h264,
      metrics.text2.characteristics_media_capabilities_not_efficient,
      metrics.text2.characteristics_media_capabilities_not_smooth,
      metrics.text2.characteristics_media_capabilities_unsupported,
      metrics.text2.characteristics_voices_sample,
      metrics.text2.characteristics_voices_sha1,
      metrics.text2.characteristics_gl_extensions_raw_software,
      metrics.text2.characteristics_gl_extensions_software,
      metrics.text2.characteristics_gl_minimal_source_software,
      metrics.text2.characteristics_gl_params_extensions_software,
      metrics.text2.characteristics_gl_params_v1_software,
      metrics.text2.characteristics_gl_params_v2_software,
      metrics.text2.characteristics_gl_precision_fragment_software,
      metrics.text2.characteristics_gl_precision_vertex_software,
      metrics.text2.characteristics_user_agent,
      metrics.text2.characteristics_gl2_extensions,
      metrics.text2.characteristics_gl2_extensions_raw,
      metrics.text2.characteristics_gl2_extensions_raw_software,
      metrics.text2.characteristics_gl2_extensions_software,
      metrics.text2.characteristics_gl2_minimal_source,
      metrics.text2.characteristics_gl2_minimal_source_software,
      metrics.text2.characteristics_gl2_params,
      metrics.text2.characteristics_gl2_params_extensions,
      metrics.text2.characteristics_gl2_params_extensions_software,
      metrics.text2.characteristics_gl2_params_software,
      metrics.text2.characteristics_gl2_precision_fragment,
      metrics.text2.characteristics_gl2_precision_fragment_software,
      metrics.text2.characteristics_gl2_precision_vertex,
      metrics.text2.characteristics_gl2_precision_vertex_software,
      metrics.text2.characteristics_gl_params,
      metrics.text2.characteristics_gl_params_software,
      metrics.text2.characteristics_math_ops_fdlibm
    ) AS `text2`,
    STRUCT(metrics.uuid.characteristics_client_identifier) AS `uuid`
  ) AS `metrics`,
  normalized_app_name,
  normalized_country_code,
  normalized_os,
  normalized_os_version,
  sample_id,
  submission_timestamp
FROM
  `moz-fx-data-shared-prod.org_mozilla_firefox_beta.user_characteristics`
UNION ALL
SELECT
  "org_mozilla_fenix" AS normalized_app_id,
    -- set app build to 21850000 since all affected pings are coming from versions older than that
    -- abb build only used to differentiate between preview (pre 21850000) and nightly (everything after)
  mozfun.norm.fenix_app_info("org_mozilla_fenix", '21850000').channel AS normalized_channel,
  additional_properties,
  document_id,
  events,
  metadata,
  STRUCT(
    STRUCT(
      metrics.boolean.characteristics_font_name_list_emoji_modified,
      metrics.boolean.characteristics_inverted_colors,
      metrics.boolean.characteristics_monochrome,
      metrics.boolean.characteristics_pdf_viewer,
      metrics.boolean.characteristics_prefers_reduced_motion,
      metrics.boolean.characteristics_prefers_reduced_transparency,
      metrics.boolean.characteristics_prefs_block_popups,
      metrics.boolean.characteristics_prefs_browser_display_use_document_fonts,
      metrics.boolean.characteristics_prefs_general_autoscroll,
      metrics.boolean.characteristics_prefs_general_smoothscroll,
      metrics.boolean.characteristics_prefs_media_eme_enabled,
      metrics.boolean.characteristics_prefs_overlay_scrollbars,
      metrics.boolean.characteristics_prefs_privacy_donottrackheader_enabled,
      metrics.boolean.characteristics_prefs_privacy_globalprivacycontrol_enabled,
      metrics.boolean.characteristics_prefs_zoom_text_only,
      metrics.boolean.characteristics_use_document_colors,
      metrics.boolean.characteristics_video_dynamic_range,
      metrics.boolean.characteristics_using_accelerated_canvas
    ) AS `boolean`,
    STRUCT(
      metrics.labeled_counter.glean_error_invalid_label,
      metrics.labeled_counter.glean_error_invalid_overflow,
      metrics.labeled_counter.glean_error_invalid_state,
      metrics.labeled_counter.glean_error_invalid_value
    ) AS `labeled_counter`,
    STRUCT(
      metrics.quantity.characteristics_any_pointer_type,
      metrics.quantity.characteristics_audio_channels,
      metrics.quantity.characteristics_audio_fingerprint,
      metrics.quantity.characteristics_audio_frames,
      metrics.quantity.characteristics_audio_rate,
      metrics.quantity.characteristics_avail_height,
      metrics.quantity.characteristics_avail_width,
      metrics.quantity.characteristics_build_date,
      metrics.quantity.characteristics_color_accentcolor,
      metrics.quantity.characteristics_color_accentcolortext,
      metrics.quantity.characteristics_color_canvas,
      metrics.quantity.characteristics_color_canvastext,
      metrics.quantity.characteristics_color_depth,
      metrics.quantity.characteristics_color_gamut,
      metrics.quantity.characteristics_color_highlight,
      metrics.quantity.characteristics_color_highlighttext,
      metrics.quantity.characteristics_color_scheme,
      metrics.quantity.characteristics_color_selecteditem,
      metrics.quantity.characteristics_color_selecteditemtext,
      metrics.quantity.characteristics_font_default_modified,
      metrics.quantity.characteristics_font_minimum_size_modified,
      metrics.quantity.characteristics_font_name_list_cursive_modified,
      metrics.quantity.characteristics_font_name_list_monospace_modified,
      metrics.quantity.characteristics_font_name_list_sans_serif_modified,
      metrics.quantity.characteristics_font_name_list_serif_modified,
      metrics.quantity.characteristics_font_name_monospace_modified,
      metrics.quantity.characteristics_font_name_sans_serif_modified,
      metrics.quantity.characteristics_font_name_serif_modified,
      metrics.quantity.characteristics_font_size_monospace_modified,
      metrics.quantity.characteristics_font_size_variable_modified,
      metrics.quantity.characteristics_inner_height,
      metrics.quantity.characteristics_inner_width,
      metrics.quantity.characteristics_mathml1,
      metrics.quantity.characteristics_mathml10,
      metrics.quantity.characteristics_mathml2,
      metrics.quantity.characteristics_mathml3,
      metrics.quantity.characteristics_mathml4,
      metrics.quantity.characteristics_mathml5,
      metrics.quantity.characteristics_mathml6,
      metrics.quantity.characteristics_mathml7,
      metrics.quantity.characteristics_mathml8,
      metrics.quantity.characteristics_mathml9,
      metrics.quantity.characteristics_max_touch_points,
      metrics.quantity.characteristics_motion_decimals,
      metrics.quantity.characteristics_motion_freq,
      metrics.quantity.characteristics_orientation_angle,
      metrics.quantity.characteristics_orientation_decimals,
      metrics.quantity.characteristics_orientation_freq,
      metrics.quantity.characteristics_orientationabs_decimals,
      metrics.quantity.characteristics_orientationabs_freq,
      metrics.quantity.characteristics_outer_height,
      metrics.quantity.characteristics_outer_width,
      metrics.quantity.characteristics_pixel_depth,
      metrics.quantity.characteristics_pixel_ratio,
      metrics.quantity.characteristics_pointer_height,
      metrics.quantity.characteristics_pointer_tiltx,
      metrics.quantity.characteristics_pointer_tilty,
      metrics.quantity.characteristics_pointer_twist,
      metrics.quantity.characteristics_pointer_type,
      metrics.quantity.characteristics_pointer_width,
      metrics.quantity.characteristics_posx,
      metrics.quantity.characteristics_posy,
      metrics.quantity.characteristics_prefers_contrast,
      metrics.quantity.characteristics_prefs_network_cookie_cookiebehavior,
      metrics.quantity.characteristics_processor_count,
      metrics.quantity.characteristics_screen_height,
      metrics.quantity.characteristics_screen_orientation,
      metrics.quantity.characteristics_screen_width,
      metrics.quantity.characteristics_size_mode,
      metrics.quantity.characteristics_submission_schema,
      metrics.quantity.characteristics_target_frame_rate,
      metrics.quantity.characteristics_zoom_count,
      metrics.quantity.characteristics_camera_count,
      metrics.quantity.characteristics_gl_version,
      metrics.quantity.characteristics_group_count,
      metrics.quantity.characteristics_group_count_wo_speakers,
      metrics.quantity.characteristics_ice_order,
      metrics.quantity.characteristics_ice_sd,
      metrics.quantity.characteristics_microphone_count,
      metrics.quantity.characteristics_speaker_count,
      metrics.quantity.characteristics_voices_count,
      metrics.quantity.characteristics_voices_local_count,
      metrics.quantity.characteristics_gl_version_software,
      metrics.quantity.characteristics_wgpu_maxbindgroups,
      metrics.quantity.characteristics_wgpu_maxbindgroupsplusvertexbuffers,
      metrics.quantity.characteristics_wgpu_maxbindingsperbindgroup,
      metrics.quantity.characteristics_wgpu_maxbuffersize,
      metrics.quantity.characteristics_wgpu_maxcolorattachmentbytespersample,
      metrics.quantity.characteristics_wgpu_maxcolorattachments,
      metrics.quantity.characteristics_wgpu_maxcomputeinvocationsperworkgroup,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizex,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizey,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizez,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsperdimension,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupstoragesize,
      metrics.quantity.characteristics_wgpu_maxdynamicstoragebuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxdynamicuniformbuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxinterstageshadervariables,
      metrics.quantity.characteristics_wgpu_maxsampledtexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxsamplerspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragebufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxstoragebufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragetexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxtexturearraylayers,
      metrics.quantity.characteristics_wgpu_maxtexturedimension1d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension2d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension3d,
      metrics.quantity.characteristics_wgpu_maxuniformbufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxuniformbufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxvertexattributes,
      metrics.quantity.characteristics_wgpu_maxvertexbufferarraystride,
      metrics.quantity.characteristics_wgpu_maxvertexbuffers,
      metrics.quantity.characteristics_wgpu_minstoragebufferoffsetalignment,
      metrics.quantity.characteristics_wgpu_minuniformbufferoffsetalignment,
      metrics.quantity.characteristics_gl2_version_software
    ) AS `quantity`,
    STRUCT(
      metrics.string.characteristics_canvasdata1,
      metrics.string.characteristics_canvasdata10,
      metrics.string.characteristics_canvasdata10software,
      metrics.string.characteristics_canvasdata11_webgl,
      metrics.string.characteristics_canvasdata11_webglsoftware,
      metrics.string.characteristics_canvasdata12_fingerprintjs1,
      metrics.string.characteristics_canvasdata12_fingerprintjs1software,
      metrics.string.characteristics_canvasdata13_fingerprintjs2,
      metrics.string.characteristics_canvasdata13_fingerprintjs2software,
      metrics.string.characteristics_canvasdata1software,
      metrics.string.characteristics_canvasdata2,
      metrics.string.characteristics_canvasdata2software,
      metrics.string.characteristics_canvasdata3,
      metrics.string.characteristics_canvasdata3software,
      metrics.string.characteristics_canvasdata4,
      metrics.string.characteristics_canvasdata4software,
      metrics.string.characteristics_canvasdata5,
      metrics.string.characteristics_canvasdata5software,
      metrics.string.characteristics_canvasdata6,
      metrics.string.characteristics_canvasdata6software,
      metrics.string.characteristics_canvasdata7,
      metrics.string.characteristics_canvasdata7software,
      metrics.string.characteristics_canvasdata8,
      metrics.string.characteristics_canvasdata8software,
      metrics.string.characteristics_canvasdata9,
      metrics.string.characteristics_canvasdata9software,
      metrics.string.characteristics_changed_media_prefs,
      metrics.string.characteristics_channel,
      metrics.string.characteristics_cpu_model,
      metrics.string.characteristics_font_default_default_group,
      metrics.string.characteristics_font_default_western,
      metrics.string.characteristics_font_minimum_size_default_group,
      metrics.string.characteristics_font_minimum_size_western,
      metrics.string.characteristics_font_name_monospace_default_group,
      metrics.string.characteristics_font_name_monospace_western,
      metrics.string.characteristics_font_name_sans_serif_default_group,
      metrics.string.characteristics_font_name_sans_serif_western,
      metrics.string.characteristics_font_name_serif_default_group,
      metrics.string.characteristics_font_name_serif_western,
      metrics.string.characteristics_font_size_monospace_default_group,
      metrics.string.characteristics_font_size_monospace_western,
      metrics.string.characteristics_font_size_variable_default_group,
      metrics.string.characteristics_font_size_variable_western,
      metrics.string.characteristics_intl_locale,
      metrics.string.characteristics_keyboard_layout,
      metrics.string.characteristics_languages,
      metrics.string.characteristics_os_name,
      metrics.string.characteristics_os_version,
      metrics.string.characteristics_oscpu,
      metrics.string.characteristics_platform,
      metrics.string.characteristics_pointer_pressure,
      metrics.string.characteristics_pointer_tangentinal_pressure,
      metrics.string.characteristics_prefs_intl_accept_languages,
      metrics.string.characteristics_scalings,
      metrics.string.characteristics_system_locale,
      metrics.string.characteristics_text_anti_aliasing,
      metrics.string.characteristics_timezone,
      metrics.string.characteristics_touch_rotation_angle,
      metrics.string.characteristics_version,
      metrics.string.glean_client_annotation_experimentation_id,
      metrics.string.characteristics_gl_fragment_shader,
      metrics.string.characteristics_gl_renderer,
      metrics.string.characteristics_gl_renderer_raw,
      metrics.string.characteristics_gl_vendor,
      metrics.string.characteristics_gl_vendor_raw,
      metrics.string.characteristics_gl_version_raw,
      metrics.string.characteristics_gl_vertex_shader,
      metrics.string.characteristics_voices_all_ssdeep,
      metrics.string.characteristics_voices_default,
      metrics.string.characteristics_voices_local_ssdeep,
      metrics.string.characteristics_voices_nonlocal_ssdeep,
      metrics.string.characteristics_gl_context_type,
      metrics.string.characteristics_gl_context_type_software,
      metrics.string.characteristics_gl_fragment_shader_software,
      metrics.string.characteristics_gl_renderer_raw_software,
      metrics.string.characteristics_gl_renderer_software,
      metrics.string.characteristics_gl_vendor_raw_software,
      metrics.string.characteristics_gl_vendor_software,
      metrics.string.characteristics_gl_version_raw_software,
      metrics.string.characteristics_gl_vertex_shader_software,
      metrics.string.characteristics_canvasdata3avif,
      metrics.string.characteristics_canvasdata3avifsoftware,
      metrics.string.characteristics_canvasdata3cspsafe,
      metrics.string.characteristics_canvasdata3cspsafesoftware,
      metrics.string.characteristics_canvasdata3png,
      metrics.string.characteristics_canvasdata3pngsoftware,
      metrics.string.characteristics_canvasdata3webp,
      metrics.string.characteristics_canvasdata3webpsoftware,
      metrics.string.characteristics_canvas_feature_status,
      metrics.string.characteristics_wgpu_missing_features,
      metrics.string.characteristics_cpu_arch,
      metrics.string.characteristics_gl2_context_type,
      metrics.string.characteristics_gl2_context_type_software,
      metrics.string.characteristics_gl2_fragment_shader,
      metrics.string.characteristics_gl2_fragment_shader_software,
      metrics.string.characteristics_gl2_renderer,
      metrics.string.characteristics_gl2_renderer_raw,
      metrics.string.characteristics_gl2_renderer_raw_software,
      metrics.string.characteristics_gl2_renderer_software,
      metrics.string.characteristics_gl2_vendor,
      metrics.string.characteristics_gl2_vendor_raw,
      metrics.string.characteristics_gl2_vendor_raw_software,
      metrics.string.characteristics_gl2_vendor_software,
      metrics.string.characteristics_gl2_version_raw,
      metrics.string.characteristics_gl2_version_raw_software,
      metrics.string.characteristics_gl2_vertex_shader,
      metrics.string.characteristics_gl2_vertex_shader_software,
      metrics.string.characteristics_mathml1,
      metrics.string.characteristics_mathml10,
      metrics.string.characteristics_mathml2,
      metrics.string.characteristics_mathml3,
      metrics.string.characteristics_mathml4,
      metrics.string.characteristics_mathml5,
      metrics.string.characteristics_mathml6,
      metrics.string.characteristics_mathml7,
      metrics.string.characteristics_mathml8,
      metrics.string.characteristics_mathml9,
      metrics.string.characteristics_canvas_dpr
    ) AS `string`,
    STRUCT(metrics.string_list.characteristics_gamepads) AS `string_list`,
    STRUCT(
      metrics.text2.characteristics_audio_devices,
      metrics.text2.characteristics_canvasdata1,
      metrics.text2.characteristics_canvasdata10,
      metrics.text2.characteristics_canvasdata11_webgl,
      metrics.text2.characteristics_canvasdata12_fingerprintjs1,
      metrics.text2.characteristics_canvasdata13_fingerprintjs2,
      metrics.text2.characteristics_canvasdata2,
      metrics.text2.characteristics_canvasdata3,
      metrics.text2.characteristics_canvasdata4,
      metrics.text2.characteristics_canvasdata5,
      metrics.text2.characteristics_canvasdata6,
      metrics.text2.characteristics_canvasdata7,
      metrics.text2.characteristics_canvasdata8,
      metrics.text2.characteristics_canvasdata9,
      metrics.text2.characteristics_errors,
      metrics.text2.characteristics_ice_foundations,
      metrics.text2.characteristics_js_errors,
      metrics.text2.characteristics_math_ops,
      metrics.text2.characteristics_media_capabilities,
      metrics.text2.characteristics_media_devices,
      metrics.text2.characteristics_missing_fonts,
      metrics.text2.characteristics_voices,
      metrics.text2.characteristics_webglinfo,
      metrics.text2.characteristics_gl_extensions,
      metrics.text2.characteristics_gl_extensions_raw,
      metrics.text2.characteristics_gl_minimal_source,
      metrics.text2.characteristics_gl_params_extensions,
      metrics.text2.characteristics_gl_params_v1,
      metrics.text2.characteristics_gl_params_v2,
      metrics.text2.characteristics_gl_precision_fragment,
      metrics.text2.characteristics_gl_precision_vertex,
      metrics.text2.characteristics_media_capabilities_h264,
      metrics.text2.characteristics_media_capabilities_not_efficient,
      metrics.text2.characteristics_media_capabilities_not_smooth,
      metrics.text2.characteristics_media_capabilities_unsupported,
      metrics.text2.characteristics_voices_sample,
      metrics.text2.characteristics_voices_sha1,
      metrics.text2.characteristics_gl_extensions_raw_software,
      metrics.text2.characteristics_gl_extensions_software,
      metrics.text2.characteristics_gl_minimal_source_software,
      metrics.text2.characteristics_gl_params_extensions_software,
      metrics.text2.characteristics_gl_params_v1_software,
      metrics.text2.characteristics_gl_params_v2_software,
      metrics.text2.characteristics_gl_precision_fragment_software,
      metrics.text2.characteristics_gl_precision_vertex_software,
      metrics.text2.characteristics_user_agent,
      metrics.text2.characteristics_gl2_extensions,
      metrics.text2.characteristics_gl2_extensions_raw,
      metrics.text2.characteristics_gl2_extensions_raw_software,
      metrics.text2.characteristics_gl2_extensions_software,
      metrics.text2.characteristics_gl2_minimal_source,
      metrics.text2.characteristics_gl2_minimal_source_software,
      metrics.text2.characteristics_gl2_params,
      metrics.text2.characteristics_gl2_params_extensions,
      metrics.text2.characteristics_gl2_params_extensions_software,
      metrics.text2.characteristics_gl2_params_software,
      metrics.text2.characteristics_gl2_precision_fragment,
      metrics.text2.characteristics_gl2_precision_fragment_software,
      metrics.text2.characteristics_gl2_precision_vertex,
      metrics.text2.characteristics_gl2_precision_vertex_software,
      metrics.text2.characteristics_gl_params,
      metrics.text2.characteristics_gl_params_software,
      metrics.text2.characteristics_math_ops_fdlibm
    ) AS `text2`,
    STRUCT(metrics.uuid.characteristics_client_identifier) AS `uuid`
  ) AS `metrics`,
  normalized_app_name,
  normalized_country_code,
  normalized_os,
  normalized_os_version,
  sample_id,
  submission_timestamp
FROM
  `moz-fx-data-shared-prod.org_mozilla_fenix.user_characteristics`
UNION ALL
SELECT
  "org_mozilla_fenix_nightly" AS normalized_app_id,
    -- set app build to 21850000 since all affected pings are coming from versions older than that
    -- abb build only used to differentiate between preview (pre 21850000) and nightly (everything after)
  mozfun.norm.fenix_app_info("org_mozilla_fenix_nightly", '21850000').channel AS normalized_channel,
  additional_properties,
  document_id,
  events,
  metadata,
  STRUCT(
    STRUCT(
      metrics.boolean.characteristics_font_name_list_emoji_modified,
      metrics.boolean.characteristics_inverted_colors,
      metrics.boolean.characteristics_monochrome,
      metrics.boolean.characteristics_pdf_viewer,
      metrics.boolean.characteristics_prefers_reduced_motion,
      metrics.boolean.characteristics_prefers_reduced_transparency,
      metrics.boolean.characteristics_prefs_block_popups,
      metrics.boolean.characteristics_prefs_browser_display_use_document_fonts,
      metrics.boolean.characteristics_prefs_general_autoscroll,
      metrics.boolean.characteristics_prefs_general_smoothscroll,
      metrics.boolean.characteristics_prefs_media_eme_enabled,
      metrics.boolean.characteristics_prefs_overlay_scrollbars,
      metrics.boolean.characteristics_prefs_privacy_donottrackheader_enabled,
      metrics.boolean.characteristics_prefs_privacy_globalprivacycontrol_enabled,
      metrics.boolean.characteristics_prefs_zoom_text_only,
      metrics.boolean.characteristics_use_document_colors,
      metrics.boolean.characteristics_video_dynamic_range,
      metrics.boolean.characteristics_using_accelerated_canvas
    ) AS `boolean`,
    STRUCT(
      metrics.labeled_counter.glean_error_invalid_label,
      metrics.labeled_counter.glean_error_invalid_overflow,
      metrics.labeled_counter.glean_error_invalid_state,
      metrics.labeled_counter.glean_error_invalid_value
    ) AS `labeled_counter`,
    STRUCT(
      metrics.quantity.characteristics_any_pointer_type,
      metrics.quantity.characteristics_audio_channels,
      metrics.quantity.characteristics_audio_fingerprint,
      metrics.quantity.characteristics_audio_frames,
      metrics.quantity.characteristics_audio_rate,
      metrics.quantity.characteristics_avail_height,
      metrics.quantity.characteristics_avail_width,
      metrics.quantity.characteristics_build_date,
      metrics.quantity.characteristics_color_accentcolor,
      metrics.quantity.characteristics_color_accentcolortext,
      metrics.quantity.characteristics_color_canvas,
      metrics.quantity.characteristics_color_canvastext,
      metrics.quantity.characteristics_color_depth,
      metrics.quantity.characteristics_color_gamut,
      metrics.quantity.characteristics_color_highlight,
      metrics.quantity.characteristics_color_highlighttext,
      metrics.quantity.characteristics_color_scheme,
      metrics.quantity.characteristics_color_selecteditem,
      metrics.quantity.characteristics_color_selecteditemtext,
      metrics.quantity.characteristics_font_default_modified,
      metrics.quantity.characteristics_font_minimum_size_modified,
      metrics.quantity.characteristics_font_name_list_cursive_modified,
      metrics.quantity.characteristics_font_name_list_monospace_modified,
      metrics.quantity.characteristics_font_name_list_sans_serif_modified,
      metrics.quantity.characteristics_font_name_list_serif_modified,
      metrics.quantity.characteristics_font_name_monospace_modified,
      metrics.quantity.characteristics_font_name_sans_serif_modified,
      metrics.quantity.characteristics_font_name_serif_modified,
      metrics.quantity.characteristics_font_size_monospace_modified,
      metrics.quantity.characteristics_font_size_variable_modified,
      metrics.quantity.characteristics_inner_height,
      metrics.quantity.characteristics_inner_width,
      metrics.quantity.characteristics_mathml1,
      metrics.quantity.characteristics_mathml10,
      metrics.quantity.characteristics_mathml2,
      metrics.quantity.characteristics_mathml3,
      metrics.quantity.characteristics_mathml4,
      metrics.quantity.characteristics_mathml5,
      metrics.quantity.characteristics_mathml6,
      metrics.quantity.characteristics_mathml7,
      metrics.quantity.characteristics_mathml8,
      metrics.quantity.characteristics_mathml9,
      metrics.quantity.characteristics_max_touch_points,
      metrics.quantity.characteristics_motion_decimals,
      metrics.quantity.characteristics_motion_freq,
      metrics.quantity.characteristics_orientation_angle,
      metrics.quantity.characteristics_orientation_decimals,
      metrics.quantity.characteristics_orientation_freq,
      metrics.quantity.characteristics_orientationabs_decimals,
      metrics.quantity.characteristics_orientationabs_freq,
      metrics.quantity.characteristics_outer_height,
      metrics.quantity.characteristics_outer_width,
      metrics.quantity.characteristics_pixel_depth,
      metrics.quantity.characteristics_pixel_ratio,
      metrics.quantity.characteristics_pointer_height,
      metrics.quantity.characteristics_pointer_tiltx,
      metrics.quantity.characteristics_pointer_tilty,
      metrics.quantity.characteristics_pointer_twist,
      metrics.quantity.characteristics_pointer_type,
      metrics.quantity.characteristics_pointer_width,
      metrics.quantity.characteristics_posx,
      metrics.quantity.characteristics_posy,
      metrics.quantity.characteristics_prefers_contrast,
      metrics.quantity.characteristics_prefs_network_cookie_cookiebehavior,
      metrics.quantity.characteristics_processor_count,
      metrics.quantity.characteristics_screen_height,
      metrics.quantity.characteristics_screen_orientation,
      metrics.quantity.characteristics_screen_width,
      metrics.quantity.characteristics_size_mode,
      metrics.quantity.characteristics_submission_schema,
      metrics.quantity.characteristics_target_frame_rate,
      metrics.quantity.characteristics_zoom_count,
      metrics.quantity.characteristics_camera_count,
      metrics.quantity.characteristics_gl_version,
      metrics.quantity.characteristics_group_count,
      metrics.quantity.characteristics_group_count_wo_speakers,
      metrics.quantity.characteristics_ice_order,
      metrics.quantity.characteristics_ice_sd,
      metrics.quantity.characteristics_microphone_count,
      metrics.quantity.characteristics_speaker_count,
      metrics.quantity.characteristics_voices_count,
      metrics.quantity.characteristics_voices_local_count,
      metrics.quantity.characteristics_gl_version_software,
      metrics.quantity.characteristics_wgpu_maxbindgroups,
      metrics.quantity.characteristics_wgpu_maxbindgroupsplusvertexbuffers,
      metrics.quantity.characteristics_wgpu_maxbindingsperbindgroup,
      metrics.quantity.characteristics_wgpu_maxbuffersize,
      metrics.quantity.characteristics_wgpu_maxcolorattachmentbytespersample,
      metrics.quantity.characteristics_wgpu_maxcolorattachments,
      metrics.quantity.characteristics_wgpu_maxcomputeinvocationsperworkgroup,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizex,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizey,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizez,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsperdimension,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupstoragesize,
      metrics.quantity.characteristics_wgpu_maxdynamicstoragebuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxdynamicuniformbuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxinterstageshadervariables,
      metrics.quantity.characteristics_wgpu_maxsampledtexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxsamplerspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragebufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxstoragebufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragetexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxtexturearraylayers,
      metrics.quantity.characteristics_wgpu_maxtexturedimension1d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension2d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension3d,
      metrics.quantity.characteristics_wgpu_maxuniformbufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxuniformbufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxvertexattributes,
      metrics.quantity.characteristics_wgpu_maxvertexbufferarraystride,
      metrics.quantity.characteristics_wgpu_maxvertexbuffers,
      metrics.quantity.characteristics_wgpu_minstoragebufferoffsetalignment,
      metrics.quantity.characteristics_wgpu_minuniformbufferoffsetalignment,
      metrics.quantity.characteristics_gl2_version_software
    ) AS `quantity`,
    STRUCT(
      metrics.string.characteristics_canvasdata1,
      metrics.string.characteristics_canvasdata10,
      metrics.string.characteristics_canvasdata10software,
      metrics.string.characteristics_canvasdata11_webgl,
      metrics.string.characteristics_canvasdata11_webglsoftware,
      metrics.string.characteristics_canvasdata12_fingerprintjs1,
      metrics.string.characteristics_canvasdata12_fingerprintjs1software,
      metrics.string.characteristics_canvasdata13_fingerprintjs2,
      metrics.string.characteristics_canvasdata13_fingerprintjs2software,
      metrics.string.characteristics_canvasdata1software,
      metrics.string.characteristics_canvasdata2,
      metrics.string.characteristics_canvasdata2software,
      metrics.string.characteristics_canvasdata3,
      metrics.string.characteristics_canvasdata3software,
      metrics.string.characteristics_canvasdata4,
      metrics.string.characteristics_canvasdata4software,
      metrics.string.characteristics_canvasdata5,
      metrics.string.characteristics_canvasdata5software,
      metrics.string.characteristics_canvasdata6,
      metrics.string.characteristics_canvasdata6software,
      metrics.string.characteristics_canvasdata7,
      metrics.string.characteristics_canvasdata7software,
      metrics.string.characteristics_canvasdata8,
      metrics.string.characteristics_canvasdata8software,
      metrics.string.characteristics_canvasdata9,
      metrics.string.characteristics_canvasdata9software,
      metrics.string.characteristics_changed_media_prefs,
      metrics.string.characteristics_channel,
      metrics.string.characteristics_cpu_model,
      metrics.string.characteristics_font_default_default_group,
      metrics.string.characteristics_font_default_western,
      metrics.string.characteristics_font_minimum_size_default_group,
      metrics.string.characteristics_font_minimum_size_western,
      metrics.string.characteristics_font_name_monospace_default_group,
      metrics.string.characteristics_font_name_monospace_western,
      metrics.string.characteristics_font_name_sans_serif_default_group,
      metrics.string.characteristics_font_name_sans_serif_western,
      metrics.string.characteristics_font_name_serif_default_group,
      metrics.string.characteristics_font_name_serif_western,
      metrics.string.characteristics_font_size_monospace_default_group,
      metrics.string.characteristics_font_size_monospace_western,
      metrics.string.characteristics_font_size_variable_default_group,
      metrics.string.characteristics_font_size_variable_western,
      metrics.string.characteristics_intl_locale,
      metrics.string.characteristics_keyboard_layout,
      metrics.string.characteristics_languages,
      metrics.string.characteristics_os_name,
      metrics.string.characteristics_os_version,
      metrics.string.characteristics_oscpu,
      metrics.string.characteristics_platform,
      metrics.string.characteristics_pointer_pressure,
      metrics.string.characteristics_pointer_tangentinal_pressure,
      metrics.string.characteristics_prefs_intl_accept_languages,
      metrics.string.characteristics_scalings,
      metrics.string.characteristics_system_locale,
      metrics.string.characteristics_text_anti_aliasing,
      metrics.string.characteristics_timezone,
      metrics.string.characteristics_touch_rotation_angle,
      metrics.string.characteristics_version,
      metrics.string.glean_client_annotation_experimentation_id,
      metrics.string.characteristics_gl_fragment_shader,
      metrics.string.characteristics_gl_renderer,
      metrics.string.characteristics_gl_renderer_raw,
      metrics.string.characteristics_gl_vendor,
      metrics.string.characteristics_gl_vendor_raw,
      metrics.string.characteristics_gl_version_raw,
      metrics.string.characteristics_gl_vertex_shader,
      metrics.string.characteristics_voices_all_ssdeep,
      metrics.string.characteristics_voices_default,
      metrics.string.characteristics_voices_local_ssdeep,
      metrics.string.characteristics_voices_nonlocal_ssdeep,
      metrics.string.characteristics_gl_context_type,
      metrics.string.characteristics_gl_context_type_software,
      metrics.string.characteristics_gl_fragment_shader_software,
      metrics.string.characteristics_gl_renderer_raw_software,
      metrics.string.characteristics_gl_renderer_software,
      metrics.string.characteristics_gl_vendor_raw_software,
      metrics.string.characteristics_gl_vendor_software,
      metrics.string.characteristics_gl_version_raw_software,
      metrics.string.characteristics_gl_vertex_shader_software,
      metrics.string.characteristics_canvasdata3avif,
      metrics.string.characteristics_canvasdata3avifsoftware,
      metrics.string.characteristics_canvasdata3cspsafe,
      metrics.string.characteristics_canvasdata3cspsafesoftware,
      metrics.string.characteristics_canvasdata3png,
      metrics.string.characteristics_canvasdata3pngsoftware,
      metrics.string.characteristics_canvasdata3webp,
      metrics.string.characteristics_canvasdata3webpsoftware,
      metrics.string.characteristics_canvas_feature_status,
      metrics.string.characteristics_wgpu_missing_features,
      metrics.string.characteristics_cpu_arch,
      metrics.string.characteristics_gl2_context_type,
      metrics.string.characteristics_gl2_context_type_software,
      metrics.string.characteristics_gl2_fragment_shader,
      metrics.string.characteristics_gl2_fragment_shader_software,
      metrics.string.characteristics_gl2_renderer,
      metrics.string.characteristics_gl2_renderer_raw,
      metrics.string.characteristics_gl2_renderer_raw_software,
      metrics.string.characteristics_gl2_renderer_software,
      metrics.string.characteristics_gl2_vendor,
      metrics.string.characteristics_gl2_vendor_raw,
      metrics.string.characteristics_gl2_vendor_raw_software,
      metrics.string.characteristics_gl2_vendor_software,
      metrics.string.characteristics_gl2_version_raw,
      metrics.string.characteristics_gl2_version_raw_software,
      metrics.string.characteristics_gl2_vertex_shader,
      metrics.string.characteristics_gl2_vertex_shader_software,
      metrics.string.characteristics_mathml1,
      metrics.string.characteristics_mathml10,
      metrics.string.characteristics_mathml2,
      metrics.string.characteristics_mathml3,
      metrics.string.characteristics_mathml4,
      metrics.string.characteristics_mathml5,
      metrics.string.characteristics_mathml6,
      metrics.string.characteristics_mathml7,
      metrics.string.characteristics_mathml8,
      metrics.string.characteristics_mathml9,
      metrics.string.characteristics_canvas_dpr
    ) AS `string`,
    STRUCT(metrics.string_list.characteristics_gamepads) AS `string_list`,
    STRUCT(
      metrics.text2.characteristics_audio_devices,
      metrics.text2.characteristics_canvasdata1,
      metrics.text2.characteristics_canvasdata10,
      metrics.text2.characteristics_canvasdata11_webgl,
      metrics.text2.characteristics_canvasdata12_fingerprintjs1,
      metrics.text2.characteristics_canvasdata13_fingerprintjs2,
      metrics.text2.characteristics_canvasdata2,
      metrics.text2.characteristics_canvasdata3,
      metrics.text2.characteristics_canvasdata4,
      metrics.text2.characteristics_canvasdata5,
      metrics.text2.characteristics_canvasdata6,
      metrics.text2.characteristics_canvasdata7,
      metrics.text2.characteristics_canvasdata8,
      metrics.text2.characteristics_canvasdata9,
      metrics.text2.characteristics_errors,
      metrics.text2.characteristics_ice_foundations,
      metrics.text2.characteristics_js_errors,
      metrics.text2.characteristics_math_ops,
      metrics.text2.characteristics_media_capabilities,
      metrics.text2.characteristics_media_devices,
      metrics.text2.characteristics_missing_fonts,
      metrics.text2.characteristics_voices,
      metrics.text2.characteristics_webglinfo,
      metrics.text2.characteristics_gl_extensions,
      metrics.text2.characteristics_gl_extensions_raw,
      metrics.text2.characteristics_gl_minimal_source,
      metrics.text2.characteristics_gl_params_extensions,
      metrics.text2.characteristics_gl_params_v1,
      metrics.text2.characteristics_gl_params_v2,
      metrics.text2.characteristics_gl_precision_fragment,
      metrics.text2.characteristics_gl_precision_vertex,
      metrics.text2.characteristics_media_capabilities_h264,
      metrics.text2.characteristics_media_capabilities_not_efficient,
      metrics.text2.characteristics_media_capabilities_not_smooth,
      metrics.text2.characteristics_media_capabilities_unsupported,
      metrics.text2.characteristics_voices_sample,
      metrics.text2.characteristics_voices_sha1,
      metrics.text2.characteristics_gl_extensions_raw_software,
      metrics.text2.characteristics_gl_extensions_software,
      metrics.text2.characteristics_gl_minimal_source_software,
      metrics.text2.characteristics_gl_params_extensions_software,
      metrics.text2.characteristics_gl_params_v1_software,
      metrics.text2.characteristics_gl_params_v2_software,
      metrics.text2.characteristics_gl_precision_fragment_software,
      metrics.text2.characteristics_gl_precision_vertex_software,
      metrics.text2.characteristics_user_agent,
      metrics.text2.characteristics_gl2_extensions,
      metrics.text2.characteristics_gl2_extensions_raw,
      metrics.text2.characteristics_gl2_extensions_raw_software,
      metrics.text2.characteristics_gl2_extensions_software,
      metrics.text2.characteristics_gl2_minimal_source,
      metrics.text2.characteristics_gl2_minimal_source_software,
      metrics.text2.characteristics_gl2_params,
      metrics.text2.characteristics_gl2_params_extensions,
      metrics.text2.characteristics_gl2_params_extensions_software,
      metrics.text2.characteristics_gl2_params_software,
      metrics.text2.characteristics_gl2_precision_fragment,
      metrics.text2.characteristics_gl2_precision_fragment_software,
      metrics.text2.characteristics_gl2_precision_vertex,
      metrics.text2.characteristics_gl2_precision_vertex_software,
      metrics.text2.characteristics_gl_params,
      metrics.text2.characteristics_gl_params_software,
      metrics.text2.characteristics_math_ops_fdlibm
    ) AS `text2`,
    STRUCT(metrics.uuid.characteristics_client_identifier) AS `uuid`
  ) AS `metrics`,
  normalized_app_name,
  normalized_country_code,
  normalized_os,
  normalized_os_version,
  sample_id,
  submission_timestamp
FROM
  `moz-fx-data-shared-prod.org_mozilla_fenix_nightly.user_characteristics`
UNION ALL
SELECT
  "org_mozilla_fennec_aurora" AS normalized_app_id,
    -- set app build to 21850000 since all affected pings are coming from versions older than that
    -- abb build only used to differentiate between preview (pre 21850000) and nightly (everything after)
  mozfun.norm.fenix_app_info("org_mozilla_fennec_aurora", '21850000').channel AS normalized_channel,
  additional_properties,
  document_id,
  events,
  metadata,
  STRUCT(
    STRUCT(
      metrics.boolean.characteristics_font_name_list_emoji_modified,
      metrics.boolean.characteristics_inverted_colors,
      metrics.boolean.characteristics_monochrome,
      metrics.boolean.characteristics_pdf_viewer,
      metrics.boolean.characteristics_prefers_reduced_motion,
      metrics.boolean.characteristics_prefers_reduced_transparency,
      metrics.boolean.characteristics_prefs_block_popups,
      metrics.boolean.characteristics_prefs_browser_display_use_document_fonts,
      metrics.boolean.characteristics_prefs_general_autoscroll,
      metrics.boolean.characteristics_prefs_general_smoothscroll,
      metrics.boolean.characteristics_prefs_media_eme_enabled,
      metrics.boolean.characteristics_prefs_overlay_scrollbars,
      metrics.boolean.characteristics_prefs_privacy_donottrackheader_enabled,
      metrics.boolean.characteristics_prefs_privacy_globalprivacycontrol_enabled,
      metrics.boolean.characteristics_prefs_zoom_text_only,
      metrics.boolean.characteristics_use_document_colors,
      metrics.boolean.characteristics_video_dynamic_range,
      metrics.boolean.characteristics_using_accelerated_canvas
    ) AS `boolean`,
    STRUCT(
      metrics.labeled_counter.glean_error_invalid_label,
      metrics.labeled_counter.glean_error_invalid_overflow,
      metrics.labeled_counter.glean_error_invalid_state,
      metrics.labeled_counter.glean_error_invalid_value
    ) AS `labeled_counter`,
    STRUCT(
      metrics.quantity.characteristics_any_pointer_type,
      metrics.quantity.characteristics_audio_channels,
      metrics.quantity.characteristics_audio_fingerprint,
      metrics.quantity.characteristics_audio_frames,
      metrics.quantity.characteristics_audio_rate,
      metrics.quantity.characteristics_avail_height,
      metrics.quantity.characteristics_avail_width,
      metrics.quantity.characteristics_build_date,
      metrics.quantity.characteristics_color_accentcolor,
      metrics.quantity.characteristics_color_accentcolortext,
      metrics.quantity.characteristics_color_canvas,
      metrics.quantity.characteristics_color_canvastext,
      metrics.quantity.characteristics_color_depth,
      metrics.quantity.characteristics_color_gamut,
      metrics.quantity.characteristics_color_highlight,
      metrics.quantity.characteristics_color_highlighttext,
      metrics.quantity.characteristics_color_scheme,
      metrics.quantity.characteristics_color_selecteditem,
      metrics.quantity.characteristics_color_selecteditemtext,
      metrics.quantity.characteristics_font_default_modified,
      metrics.quantity.characteristics_font_minimum_size_modified,
      metrics.quantity.characteristics_font_name_list_cursive_modified,
      metrics.quantity.characteristics_font_name_list_monospace_modified,
      metrics.quantity.characteristics_font_name_list_sans_serif_modified,
      metrics.quantity.characteristics_font_name_list_serif_modified,
      metrics.quantity.characteristics_font_name_monospace_modified,
      metrics.quantity.characteristics_font_name_sans_serif_modified,
      metrics.quantity.characteristics_font_name_serif_modified,
      metrics.quantity.characteristics_font_size_monospace_modified,
      metrics.quantity.characteristics_font_size_variable_modified,
      metrics.quantity.characteristics_inner_height,
      metrics.quantity.characteristics_inner_width,
      metrics.quantity.characteristics_mathml1,
      metrics.quantity.characteristics_mathml10,
      metrics.quantity.characteristics_mathml2,
      metrics.quantity.characteristics_mathml3,
      metrics.quantity.characteristics_mathml4,
      metrics.quantity.characteristics_mathml5,
      metrics.quantity.characteristics_mathml6,
      metrics.quantity.characteristics_mathml7,
      metrics.quantity.characteristics_mathml8,
      metrics.quantity.characteristics_mathml9,
      metrics.quantity.characteristics_max_touch_points,
      metrics.quantity.characteristics_motion_decimals,
      metrics.quantity.characteristics_motion_freq,
      metrics.quantity.characteristics_orientation_angle,
      metrics.quantity.characteristics_orientation_decimals,
      metrics.quantity.characteristics_orientation_freq,
      metrics.quantity.characteristics_orientationabs_decimals,
      metrics.quantity.characteristics_orientationabs_freq,
      metrics.quantity.characteristics_outer_height,
      metrics.quantity.characteristics_outer_width,
      metrics.quantity.characteristics_pixel_depth,
      metrics.quantity.characteristics_pixel_ratio,
      metrics.quantity.characteristics_pointer_height,
      metrics.quantity.characteristics_pointer_tiltx,
      metrics.quantity.characteristics_pointer_tilty,
      metrics.quantity.characteristics_pointer_twist,
      metrics.quantity.characteristics_pointer_type,
      metrics.quantity.characteristics_pointer_width,
      metrics.quantity.characteristics_posx,
      metrics.quantity.characteristics_posy,
      metrics.quantity.characteristics_prefers_contrast,
      metrics.quantity.characteristics_prefs_network_cookie_cookiebehavior,
      metrics.quantity.characteristics_processor_count,
      metrics.quantity.characteristics_screen_height,
      metrics.quantity.characteristics_screen_orientation,
      metrics.quantity.characteristics_screen_width,
      metrics.quantity.characteristics_size_mode,
      metrics.quantity.characteristics_submission_schema,
      metrics.quantity.characteristics_target_frame_rate,
      metrics.quantity.characteristics_zoom_count,
      metrics.quantity.characteristics_camera_count,
      metrics.quantity.characteristics_gl_version,
      metrics.quantity.characteristics_group_count,
      metrics.quantity.characteristics_group_count_wo_speakers,
      metrics.quantity.characteristics_ice_order,
      metrics.quantity.characteristics_ice_sd,
      metrics.quantity.characteristics_microphone_count,
      metrics.quantity.characteristics_speaker_count,
      metrics.quantity.characteristics_voices_count,
      metrics.quantity.characteristics_voices_local_count,
      metrics.quantity.characteristics_gl_version_software,
      metrics.quantity.characteristics_wgpu_maxbindgroups,
      metrics.quantity.characteristics_wgpu_maxbindgroupsplusvertexbuffers,
      metrics.quantity.characteristics_wgpu_maxbindingsperbindgroup,
      metrics.quantity.characteristics_wgpu_maxbuffersize,
      metrics.quantity.characteristics_wgpu_maxcolorattachmentbytespersample,
      metrics.quantity.characteristics_wgpu_maxcolorattachments,
      metrics.quantity.characteristics_wgpu_maxcomputeinvocationsperworkgroup,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizex,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizey,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsizez,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupsperdimension,
      metrics.quantity.characteristics_wgpu_maxcomputeworkgroupstoragesize,
      metrics.quantity.characteristics_wgpu_maxdynamicstoragebuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxdynamicuniformbuffersperpipelinelayout,
      metrics.quantity.characteristics_wgpu_maxinterstageshadervariables,
      metrics.quantity.characteristics_wgpu_maxsampledtexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxsamplerspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragebufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxstoragebufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxstoragetexturespershaderstage,
      metrics.quantity.characteristics_wgpu_maxtexturearraylayers,
      metrics.quantity.characteristics_wgpu_maxtexturedimension1d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension2d,
      metrics.quantity.characteristics_wgpu_maxtexturedimension3d,
      metrics.quantity.characteristics_wgpu_maxuniformbufferbindingsize,
      metrics.quantity.characteristics_wgpu_maxuniformbufferspershaderstage,
      metrics.quantity.characteristics_wgpu_maxvertexattributes,
      metrics.quantity.characteristics_wgpu_maxvertexbufferarraystride,
      metrics.quantity.characteristics_wgpu_maxvertexbuffers,
      metrics.quantity.characteristics_wgpu_minstoragebufferoffsetalignment,
      metrics.quantity.characteristics_wgpu_minuniformbufferoffsetalignment,
      metrics.quantity.characteristics_gl2_version_software
    ) AS `quantity`,
    STRUCT(
      metrics.string.characteristics_canvasdata1,
      metrics.string.characteristics_canvasdata10,
      metrics.string.characteristics_canvasdata10software,
      metrics.string.characteristics_canvasdata11_webgl,
      metrics.string.characteristics_canvasdata11_webglsoftware,
      metrics.string.characteristics_canvasdata12_fingerprintjs1,
      metrics.string.characteristics_canvasdata12_fingerprintjs1software,
      metrics.string.characteristics_canvasdata13_fingerprintjs2,
      metrics.string.characteristics_canvasdata13_fingerprintjs2software,
      metrics.string.characteristics_canvasdata1software,
      metrics.string.characteristics_canvasdata2,
      metrics.string.characteristics_canvasdata2software,
      metrics.string.characteristics_canvasdata3,
      metrics.string.characteristics_canvasdata3software,
      metrics.string.characteristics_canvasdata4,
      metrics.string.characteristics_canvasdata4software,
      metrics.string.characteristics_canvasdata5,
      metrics.string.characteristics_canvasdata5software,
      metrics.string.characteristics_canvasdata6,
      metrics.string.characteristics_canvasdata6software,
      metrics.string.characteristics_canvasdata7,
      metrics.string.characteristics_canvasdata7software,
      metrics.string.characteristics_canvasdata8,
      metrics.string.characteristics_canvasdata8software,
      metrics.string.characteristics_canvasdata9,
      metrics.string.characteristics_canvasdata9software,
      metrics.string.characteristics_changed_media_prefs,
      metrics.string.characteristics_channel,
      metrics.string.characteristics_cpu_model,
      metrics.string.characteristics_font_default_default_group,
      metrics.string.characteristics_font_default_western,
      metrics.string.characteristics_font_minimum_size_default_group,
      metrics.string.characteristics_font_minimum_size_western,
      metrics.string.characteristics_font_name_monospace_default_group,
      metrics.string.characteristics_font_name_monospace_western,
      metrics.string.characteristics_font_name_sans_serif_default_group,
      metrics.string.characteristics_font_name_sans_serif_western,
      metrics.string.characteristics_font_name_serif_default_group,
      metrics.string.characteristics_font_name_serif_western,
      metrics.string.characteristics_font_size_monospace_default_group,
      metrics.string.characteristics_font_size_monospace_western,
      metrics.string.characteristics_font_size_variable_default_group,
      metrics.string.characteristics_font_size_variable_western,
      metrics.string.characteristics_intl_locale,
      metrics.string.characteristics_keyboard_layout,
      metrics.string.characteristics_languages,
      metrics.string.characteristics_os_name,
      metrics.string.characteristics_os_version,
      metrics.string.characteristics_oscpu,
      metrics.string.characteristics_platform,
      metrics.string.characteristics_pointer_pressure,
      metrics.string.characteristics_pointer_tangentinal_pressure,
      metrics.string.characteristics_prefs_intl_accept_languages,
      metrics.string.characteristics_scalings,
      metrics.string.characteristics_system_locale,
      metrics.string.characteristics_text_anti_aliasing,
      metrics.string.characteristics_timezone,
      metrics.string.characteristics_touch_rotation_angle,
      metrics.string.characteristics_version,
      metrics.string.glean_client_annotation_experimentation_id,
      metrics.string.characteristics_gl_fragment_shader,
      metrics.string.characteristics_gl_renderer,
      metrics.string.characteristics_gl_renderer_raw,
      metrics.string.characteristics_gl_vendor,
      metrics.string.characteristics_gl_vendor_raw,
      metrics.string.characteristics_gl_version_raw,
      metrics.string.characteristics_gl_vertex_shader,
      metrics.string.characteristics_voices_all_ssdeep,
      metrics.string.characteristics_voices_default,
      metrics.string.characteristics_voices_local_ssdeep,
      metrics.string.characteristics_voices_nonlocal_ssdeep,
      metrics.string.characteristics_gl_context_type,
      metrics.string.characteristics_gl_context_type_software,
      metrics.string.characteristics_gl_fragment_shader_software,
      metrics.string.characteristics_gl_renderer_raw_software,
      metrics.string.characteristics_gl_renderer_software,
      metrics.string.characteristics_gl_vendor_raw_software,
      metrics.string.characteristics_gl_vendor_software,
      metrics.string.characteristics_gl_version_raw_software,
      metrics.string.characteristics_gl_vertex_shader_software,
      metrics.string.characteristics_canvasdata3avif,
      metrics.string.characteristics_canvasdata3avifsoftware,
      metrics.string.characteristics_canvasdata3cspsafe,
      metrics.string.characteristics_canvasdata3cspsafesoftware,
      metrics.string.characteristics_canvasdata3png,
      metrics.string.characteristics_canvasdata3pngsoftware,
      metrics.string.characteristics_canvasdata3webp,
      metrics.string.characteristics_canvasdata3webpsoftware,
      metrics.string.characteristics_canvas_feature_status,
      metrics.string.characteristics_wgpu_missing_features,
      metrics.string.characteristics_cpu_arch,
      metrics.string.characteristics_gl2_context_type,
      metrics.string.characteristics_gl2_context_type_software,
      metrics.string.characteristics_gl2_fragment_shader,
      metrics.string.characteristics_gl2_fragment_shader_software,
      metrics.string.characteristics_gl2_renderer,
      metrics.string.characteristics_gl2_renderer_raw,
      metrics.string.characteristics_gl2_renderer_raw_software,
      metrics.string.characteristics_gl2_renderer_software,
      metrics.string.characteristics_gl2_vendor,
      metrics.string.characteristics_gl2_vendor_raw,
      metrics.string.characteristics_gl2_vendor_raw_software,
      metrics.string.characteristics_gl2_vendor_software,
      metrics.string.characteristics_gl2_version_raw,
      metrics.string.characteristics_gl2_version_raw_software,
      metrics.string.characteristics_gl2_vertex_shader,
      metrics.string.characteristics_gl2_vertex_shader_software,
      metrics.string.characteristics_mathml1,
      metrics.string.characteristics_mathml10,
      metrics.string.characteristics_mathml2,
      metrics.string.characteristics_mathml3,
      metrics.string.characteristics_mathml4,
      metrics.string.characteristics_mathml5,
      metrics.string.characteristics_mathml6,
      metrics.string.characteristics_mathml7,
      metrics.string.characteristics_mathml8,
      metrics.string.characteristics_mathml9,
      metrics.string.characteristics_canvas_dpr
    ) AS `string`,
    STRUCT(metrics.string_list.characteristics_gamepads) AS `string_list`,
    STRUCT(
      metrics.text2.characteristics_audio_devices,
      metrics.text2.characteristics_canvasdata1,
      metrics.text2.characteristics_canvasdata10,
      metrics.text2.characteristics_canvasdata11_webgl,
      metrics.text2.characteristics_canvasdata12_fingerprintjs1,
      metrics.text2.characteristics_canvasdata13_fingerprintjs2,
      metrics.text2.characteristics_canvasdata2,
      metrics.text2.characteristics_canvasdata3,
      metrics.text2.characteristics_canvasdata4,
      metrics.text2.characteristics_canvasdata5,
      metrics.text2.characteristics_canvasdata6,
      metrics.text2.characteristics_canvasdata7,
      metrics.text2.characteristics_canvasdata8,
      metrics.text2.characteristics_canvasdata9,
      metrics.text2.characteristics_errors,
      metrics.text2.characteristics_ice_foundations,
      metrics.text2.characteristics_js_errors,
      metrics.text2.characteristics_math_ops,
      metrics.text2.characteristics_media_capabilities,
      metrics.text2.characteristics_media_devices,
      metrics.text2.characteristics_missing_fonts,
      metrics.text2.characteristics_voices,
      metrics.text2.characteristics_webglinfo,
      metrics.text2.characteristics_gl_extensions,
      metrics.text2.characteristics_gl_extensions_raw,
      metrics.text2.characteristics_gl_minimal_source,
      metrics.text2.characteristics_gl_params_extensions,
      metrics.text2.characteristics_gl_params_v1,
      metrics.text2.characteristics_gl_params_v2,
      metrics.text2.characteristics_gl_precision_fragment,
      metrics.text2.characteristics_gl_precision_vertex,
      metrics.text2.characteristics_media_capabilities_h264,
      metrics.text2.characteristics_media_capabilities_not_efficient,
      metrics.text2.characteristics_media_capabilities_not_smooth,
      metrics.text2.characteristics_media_capabilities_unsupported,
      metrics.text2.characteristics_voices_sample,
      metrics.text2.characteristics_voices_sha1,
      metrics.text2.characteristics_gl_extensions_raw_software,
      metrics.text2.characteristics_gl_extensions_software,
      metrics.text2.characteristics_gl_minimal_source_software,
      metrics.text2.characteristics_gl_params_extensions_software,
      metrics.text2.characteristics_gl_params_v1_software,
      metrics.text2.characteristics_gl_params_v2_software,
      metrics.text2.characteristics_gl_precision_fragment_software,
      metrics.text2.characteristics_gl_precision_vertex_software,
      metrics.text2.characteristics_user_agent,
      metrics.text2.characteristics_gl2_extensions,
      metrics.text2.characteristics_gl2_extensions_raw,
      metrics.text2.characteristics_gl2_extensions_raw_software,
      metrics.text2.characteristics_gl2_extensions_software,
      metrics.text2.characteristics_gl2_minimal_source,
      metrics.text2.characteristics_gl2_minimal_source_software,
      metrics.text2.characteristics_gl2_params,
      metrics.text2.characteristics_gl2_params_extensions,
      metrics.text2.characteristics_gl2_params_extensions_software,
      metrics.text2.characteristics_gl2_params_software,
      metrics.text2.characteristics_gl2_precision_fragment,
      metrics.text2.characteristics_gl2_precision_fragment_software,
      metrics.text2.characteristics_gl2_precision_vertex,
      metrics.text2.characteristics_gl2_precision_vertex_software,
      metrics.text2.characteristics_gl_params,
      metrics.text2.characteristics_gl_params_software,
      metrics.text2.characteristics_math_ops_fdlibm
    ) AS `text2`,
    STRUCT(metrics.uuid.characteristics_client_identifier) AS `uuid`
  ) AS `metrics`,
  normalized_app_name,
  normalized_country_code,
  normalized_os,
  normalized_os_version,
  sample_id,
  submission_timestamp
FROM
  `moz-fx-data-shared-prod.org_mozilla_fennec_aurora.user_characteristics`
