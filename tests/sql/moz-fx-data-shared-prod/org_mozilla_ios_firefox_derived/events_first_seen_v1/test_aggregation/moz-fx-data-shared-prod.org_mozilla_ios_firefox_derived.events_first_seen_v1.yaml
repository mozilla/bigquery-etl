---
# Historical record for client3-existing (already seen with same criteria)
- first_submission_timestamp: 2025-10-15T08:00:00+00:00
  client_id: client3-existing
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client3-existing-profile-old"
  sample_id: 2
  first_event_timestamp: 2025-10-15T08:00:00+00:00
  event_extra: {surface: "bottom_sheet", version: "1.0"}
  normalized_channel: "beta"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "16.5"
  windows_build_number: null

# Historical record not in current day (should not appear in output)
- first_submission_timestamp: 2025-10-20T09:00:00+00:00
  client_id: client16-history-only
  event: "onboarding#terms_of_service_accepted"
  event_category: "onboarding"
  event_name: "terms_of_service_accepted"
  criteria: "tou_accept"
  profile_group_id: "client16-profile"
  sample_id: 5
  first_event_timestamp: 2025-10-20T09:00:00+00:00
  event_extra: {}
  normalized_channel: "release"
  normalized_country_code: "DE"
  normalized_os: "iOS"
  normalized_os_version: "17.0"
  windows_build_number: null

# Historical record with different criteria (should NOT match in JOIN)
- first_submission_timestamp: 2025-10-18T10:00:00+00:00
  client_id: client9-diff-criteria
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "different_criteria"  # Different criteria
  profile_group_id: "client9-profile-old"
  sample_id: 0
  first_event_timestamp: 2025-10-18T10:00:00+00:00
  event_extra: {surface: "bottom_sheet"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "16.5"
  windows_build_number: null

# Historical record with NULL criteria (should NOT match due to IS NOT DISTINCT FROM filter)
- first_submission_timestamp: 2025-10-16T10:00:00+00:00
  client_id: client17-null-criteria
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: null  # NULL criteria
  profile_group_id: "client17-profile"
  sample_id: 0
  first_event_timestamp: 2025-10-16T10:00:00+00:00
  event_extra: {surface: "bottom_sheet"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "16.5"
  windows_build_number: null

# Historical record before 2023-01-01 (should be excluded from _previous)
- first_submission_timestamp: 2022-12-31T10:00:00+00:00
  client_id: client1-tou-new
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client1-tou-profile-old"
  sample_id: 0
  first_event_timestamp: 2022-12-31T10:00:00+00:00
  event_extra: {surface: "bottom_sheet"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "16.0"
  windows_build_number: null

# Historical record on @submission_date (should be excluded from _previous)
- first_submission_timestamp: 2025-10-29T05:00:00+00:00
  client_id: client18-same-date
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client18-profile"
  sample_id: 0
  first_event_timestamp: 2025-10-29T05:00:00+00:00
  event_extra: {surface: "bottom_sheet"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "17.0"
  windows_build_number: null

# Historical record for one event type but not the other (client8)
- first_submission_timestamp: 2025-10-18T10:00:00+00:00
  client_id: client8-partial-history
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client8-profile-old"
  sample_id: 0
  first_event_timestamp: 2025-10-18T10:00:00+00:00
  event_extra: {surface: "bottom_sheet"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "16.5"
  windows_build_number: null
