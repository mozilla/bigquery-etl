friendly_name: Baseline Clients City Seen
description: |-
  This table stores the first-seen and last-seen geo attributes for each client_id.
  The table was initialized from stable tables (with finite retention) in Oct. 2025,
  so the initial dates reflect the earliest/latest observations within that window.
  After initialization, the city fields in the stable tables are nullified and
  the one-time initialization code is no longer relevant.  The table is updated daily using live tables,
  updating last-seen fields for existing clients and adding new clients with first-seen geo attributes
  that do not yet exist in the table.
  This table should not be backfilled beyond 30 days which is the maximum retention of live tables.

  JIRA ticket: https://mozilla-hub.atlassian.net/browse/DENG-9468
owners:
- wichan@mozilla.com
labels:
  incremental: true
  schedule: daily
  table_type: client_level
  dag: bqetl_baseline_clients_city_seen
  owner1: wichan
scheduling:
  dag_name: bqetl_baseline_clients_city_seen
  task_name: firefox_desktop_background_tasks_baseline_clients_city_seen_v1
  depends_on_past: true
  date_partition_parameter: null
  parameters:
  - submission_date:DATE:{{ds}}
bigquery:
  time_partitioning:
    type: day
    field: first_seen_city_date
    require_partition_filter: false
    expiration_days: null
  range_partitioning: null
  clustering:
    fields:
    - sample_id
workgroup_access:
- role: roles/bigquery.dataViewer
  members:
  - workgroup:mozilla-confidential
references:
  query.sql:
  - moz-fx-data-shared-prod.firefox_desktop_background_tasks_derived.baseline_clients_city_seen_v1
  - moz-fx-data-shared-prod.firefox_desktop_background_tasks_live.baseline_v1
require_column_descriptions: false
