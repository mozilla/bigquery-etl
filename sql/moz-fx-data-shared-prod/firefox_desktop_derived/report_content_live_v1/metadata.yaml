friendly_name: Report Content Live
description: |-
  Reported organic content using the live tables.

  For each report, we collect
    submission date
    card type
    corpus item id
    report reason
    section
    section position
    title
    topic
    url
owners:
- lmcfall@mozilla.com
labels:
  incremental: true
  schedule: hourly
  shredder_mitigation: true
scheduling:
  dag_name: report_content_hourly
  date_partition_parameter: null
  # We reprocess the same day every hour up until 1:00 the following day, to give
  # the live data time to come in
  destination_table: >-
    report_content_live_v1${{
    (execution_date - macros.timedelta(hours=1)).strftime("%Y%m%d")
    }}
  parameters:
  - >-
    submission_date:DATE:{{
    (execution_date - macros.timedelta(hours=1)).strftime('%Y-%m-%d')
    }}
  query_file_path:
    # explicit query file path is necessary because the destination table
    # includes a partition identifier that is not in the path
    sql/moz-fx-data-shared-prod/firefox_desktop_derived/report_content_live_v1/query.sql
bigquery:
  time_partitioning:
    type: day
    field: submission_date
    require_partition_filter: false
