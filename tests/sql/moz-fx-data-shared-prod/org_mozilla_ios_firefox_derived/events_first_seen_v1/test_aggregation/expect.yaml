---
# Test 1: New TOU event with bottom_sheet surface
- first_submission_timestamp: 2025-10-29T10:00:00+00:00
  client_id: client1-tou-new
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client1-tou-profile"
  sample_id: 0
  first_event_timestamp: 2025-10-29T10:00:00+00:00
  event_extra: {surface: "bottom_sheet", version: "1.0"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "17.0"

# Test 2: New onboarding event
- first_submission_timestamp: 2025-10-29T11:00:00+00:00
  client_id: client2-onboarding-new
  event: "onboarding#terms_of_service_accepted"
  event_category: "onboarding"
  event_name: "terms_of_service_accepted"
  criteria: "tou_accept"
  profile_group_id: "client2-onboarding-profile"
  sample_id: 1
  first_event_timestamp: 2025-10-29T11:00:00+00:00
  event_extra: {screen: "welcome"}
  normalized_channel: "beta"
  normalized_country_code: "CA"
  normalized_os: "iOS"
  normalized_os_version: "17.1"

# Test 3: client3-existing - EXCLUDED (already in history)

# Test 4-5: Wrong surface or no surface - EXCLUDED (filtered by WHERE clause)

# Test 6: Multiple events - picks earliest submission (07:00)
- first_submission_timestamp: 2025-10-29T07:00:00+00:00
  client_id: client6-multiple
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client6-profile-2"
  sample_id: 1
  first_event_timestamp: 2025-10-29T09:00:00+00:00
  event_extra: {surface: "bottom_sheet", attempt: 2}
  normalized_channel: "beta"
  normalized_country_code: "FR"
  normalized_os: "iOS"
  normalized_os_version: "17.0"

# Test 7: Different events - both new
- first_submission_timestamp: 2025-10-29T10:00:00+00:00
  client_id: client7-diff-events
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client7-profile"
  sample_id: 0
  first_event_timestamp: 2025-10-29T10:00:00+00:00
  event_extra: {surface: "bottom_sheet", type: "tou"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "17.0"
- first_submission_timestamp: 2025-10-29T11:00:00+00:00
  client_id: client7-diff-events
  event: "onboarding#terms_of_service_accepted"
  event_category: "onboarding"
  event_name: "terms_of_service_accepted"
  criteria: "tou_accept"
  profile_group_id: "client7-profile"
  sample_id: 0
  first_event_timestamp: 2025-10-29T11:00:00+00:00
  event_extra: {type: "onboarding"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "17.0"

# Test 8: Partial history - onboarding is new (tou is in history)
- first_submission_timestamp: 2025-10-29T11:00:00+00:00
  client_id: client8-partial-history
  event: "onboarding#terms_of_service_accepted"
  event_category: "onboarding"
  event_name: "terms_of_service_accepted"
  criteria: "tou_accept"
  profile_group_id: "client8-profile"
  sample_id: 0
  first_event_timestamp: 2025-10-29T11:00:00+00:00
  event_extra: {}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "17.0"

# Test 9: Different criteria - included (criteria in history is different)
- first_submission_timestamp: 2025-10-29T10:00:00+00:00
  client_id: client9-diff-criteria
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client9-profile"
  sample_id: 0
  first_event_timestamp: 2025-10-29T10:00:00+00:00
  event_extra: {surface: "bottom_sheet", criteria_test: true}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "17.0"

# Test 10: NULL event_timestamp
- first_submission_timestamp: 2025-10-29T14:00:00+00:00
  client_id: client10-null-timestamp
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client10-profile"
  sample_id: 0
  event_extra: {surface: "bottom_sheet", missing: "timestamp"}
  normalized_channel: "release"
  normalized_country_code: "JP"
  normalized_os: "iOS"
  normalized_os_version: "16.0"

# Test 11-13: Excluded (wrong category, wrong event name, wrong date) - NOT IN OUTPUT

# Test 14: All NULLs
- first_submission_timestamp: 2025-10-29T10:00:00+00:00
  client_id: client14-nulls
  event: "terms_of_use#accepted"
  event_category: "terms_of_use"
  event_name: "accepted"
  criteria: "tou_accept"
  profile_group_id: "client14-profile"
  sample_id: 0
  event_extra: {surface: "bottom_sheet"}

# Test 15: Onboarding with surface (surface not checked for onboarding)
- first_submission_timestamp: 2025-10-29T10:00:00+00:00
  client_id: client15-onboarding-surfaces
  event: "onboarding#terms_of_service_accepted"
  event_category: "onboarding"
  event_name: "terms_of_service_accepted"
  criteria: "tou_accept"
  profile_group_id: "client15-profile"
  sample_id: 0
  first_event_timestamp: 2025-10-29T10:00:00+00:00
  event_extra: {surface: "modal", screen: "welcome"}
  normalized_channel: "release"
  normalized_country_code: "US"
  normalized_os: "iOS"
  normalized_os_version: "17.0"

# Test 16: client16-history-only - NOT IN OUTPUT (not in current day)
